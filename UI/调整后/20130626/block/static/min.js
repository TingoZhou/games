(function(){function g(){return function(){}}function aa(e){var t=typeof e;if(t=="object"){if(!e)return"null";if(e instanceof Array||!(e instanceof Object)&&Object.prototype.toString.call(e)=="[object Array]"||typeof e.length=="number"&&typeof e.splice!="undefined"&&typeof e.propertyIsEnumerable!="undefined"&&!e.propertyIsEnumerable("splice"))return"array";if(!(e instanceof Object)&&(Object.prototype.toString.call(e)=="[object Function]"||typeof e.call!="undefined"&&typeof e.propertyIsEnumerable!="undefined"&&!e.propertyIsEnumerable("call")))return"function"}else if(t=="function"&&typeof e.call=="undefined")return"object";return t}function k(e,t){var n=t||j;if(arguments.length>2){var r=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,r),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function l(e,t){function n(){}n.prototype=t.prototype,e.T=t.prototype,e.prototype=new n}function p(e,t,n,r){return t+(n-t)*(e/r)}function ea(e,t,n,r){return e/=r,(n-t)*e*e+t}function fa(e,t){var n=e.indexOf(t);return n>=0?(e.splice(n,1),!0):!1}function q(e,t){e[e.length]=t}function ga(e,t,n,r){var i=e.getPropertyValue("-webkit-transition-property");if(i){var s=i.split(", ").indexOf(t);s<0?(e.setProperty("-webkit-transition-property",i+", "+t,""),e.setProperty("-webkit-transition-duration",e.getPropertyValue("-webkit-transition-duration")+", "+n,""),e.setProperty("-webkit-transition-timing-function",e.getPropertyValue("-webkit-transition-timing-function")+", "+r,"")):(t=e.getPropertyValue("-webkit-transition-duration").split(", "),t[s]=n,e.setProperty("-webkit-transition-duration",t.join(", "),""),n=e.getPropertyValue("-webkit-transition-timing-function").split(", "),n[s]=r,e.setProperty("-webkit-transition-timing-function",n.join(", "),""))}else e.setProperty("-webkit-transition-property",t,""),e.setProperty("-webkit-transition-duration",n,""),e.setProperty("-webkit-transition-timing-function",r,"")}function ha(e,t){var n=e.getPropertyValue("-webkit-transition-property");if(n){var r=n.split(", ");n=r.indexOf(t),n>=0&&(r.length>1?(r.splice(n,1),e.setProperty("-webkit-transition-property",r.join(", "),""),r=e.getPropertyValue("-webkit-transition-duration").split(", "),r.splice(n,1),e.setProperty("-webkit-transition-duration",r.join(", "),""),r=e.getPropertyValue("-webkit-transition-timing-function").split(", "),r.splice(n,1),e.setProperty("-webkit-transition-timing-function",r.join(", "),"")):(e.setProperty("-webkit-transition-property","",""),e.setProperty("-webkit-transition-duration","",""),e.setProperty("-webkit-transition-timing-function","","")))}}function r(e){var t=document.createElement("div");return t.className=e,t}function s(e){var t=document.createElement("div");return t.innerHTML=e,t.childElementCount==1&&(t=t.firstElementChild),t}function t(e){ia.call(this),this.element=e||document.createElement("div"),this.y=this.x=0,this.A=this.F=1,this.rotation=0}function ja(e,t){e.x=t,v(e)}function w(e,t){e.y=t,v(e)}function x(e,t,n){e.x=t,e.y=n,v(e)}function ka(e,t){e.F=t,e.A=t,v(e)}function v(e){e.element.style.webkitTransform="translate3d("+e.x+"px,"+e.y+"px,0)rotate("+e.rotation+"deg)scale("+e.F+","+e.A+")"}function y(e){t.call(this,e),this.q=[]}function A(e,t){e.g!=null&&t.g==null?z(e.g,t,e):(t.parent!=null&&fa(t.parent.q,t)&&(t.parent=null,t.detach()),q(e.q,t),t.parent=e,e.element.appendChild(t.element))}function B(e,t,n,r){this.l=e,this.duration=1e3*t,this.Z=n,this.S=r,this.t=la,this.m=0}function C(e,t,n){return e.J(e.m,t,n,e.duration)}function ma(e,t,n,r,i){B.call(this,e,n,r,i),this.value=t}function D(e,t,n,r,i,s){B.call(this,"-webkit-transform",n,r,s),this.x=e,this.y=t,this.J=i}function E(e,t,n,r,i,s){B.call(this,"-webkit-transform",n,r,s),this.ja=e,this.ka=t,this.J=i}function F(e,t,n,r,i,s){B.call(this,"-webkit-transform",n,r,s),this.x=e,this.y=t,this.J=i}function na(e,t,n,r,i){B.call(this,"-webkit-transform",t,n,i),this.rotation=e,this.J=r}function G(e,t,n,r){return new ma(e,t,n,"linear",r)}function H(e,t,n,r){return new D(e,t,n,"linear",p,r)}function oa(e,t,n,r){return new D(e,t,n,"ease-out",p,r)}function pa(){this.D={}}function qa(){this.L=[]}function ra(e,t,n){this.ia=e,this.la=t,this.oa=n}function ta(e){if(e!=m){m&&m.z();for(var t=I.length-1;t>=0;--t){var n=I[t];if(e==n){m=n,e.r();return}--I.length,ua(n)}I=[e],m=e,e.load(),e.r()}}function J(){if(I.length>1){var e=I.pop();e.z(),ua(e),m=I[I.length-1],m.r()}}function K(e){m&&m.z(),q(I,e),m=e,e.load(),e.r()}function ia(){this.a=[],this.g=null}function O(e){this.entities=[],this.u=[],this.name=e,this.d=new y(r("scene scene-"+e)),z(this,this.d,sa)}function z(e,n,r){n.g||(q(e.entities,n),n.p(e),n instanceof t&&(r instanceof HTMLElement?r.appendChild(n.element):r!==null&&(r=r||e.d,A(r,n))))}function ua(e){for(var t=0;t<e.entities.length;++t){var n=e.entities[t];n.g!=null&&(n.g=null,n.j())}e.entities=[],e.u=[]}function P(e){this.ma=e}function Q(e){this.Y=1e3*e,this.m=0}function R(e){this.a=e,this.H=[]}function S(e){this.U=e}function T(){}function U(e){this.a=e,this.o=0}function va(a){return eval("("+a+")")}function wa(e){var t=[];return xa(new ya,e,t),t.join("")}function ya(){}function xa(e,t,n){switch(typeof t){case"string":za(e,t,n);break;case"number":n.push(isFinite(t)&&!isNaN(t)?t:"null");break;case"boolean":n.push(t);break;case"undefined":n.push("null");break;case"object":if(t==null){n.push("null");break}if(aa(t)=="array"){var r=t.length;n.push("[");for(var i="",s=0;s<r;s++)n.push(i),xa(e,t[s],n),i=",";n.push("]");break}n.push("{"),r="";for(i in t)t.hasOwnProperty(i)&&(s=t[i],typeof s!="function"&&(n.push(r),za(e,i,n),n.push(":"),xa(e,s,n),r=","));n.push("}");break;case"function":break;default:throw Error("Unknown type: "+typeof t)}}function za(e,t,n){n.push('"',t.replace(Ba,function(e){if(e in Aa)return Aa[e];var t=e.charCodeAt(0),n="\\u";return t<16?n+="000":t<256?n+="00":t<4096&&(n+="0"),Aa[e]=n+t.toString(16)}),'"')}function V(e){t.call(this,e),this.Fa=!1,e=this.element,e.className?(" "+e.className+" ").indexOf(" button ")>=0||(e.className+=" button"):e.className="button",this.e(this.element,"touchstart",this),this.e(this.element,"touchend",this),this.e(this.element,"touchcancel",this)}function Ca(){O.call(this,"orientation")}function Da(e,t){return t?e.replace(Ea,"&amp;").replace(Fa,"&lt;").replace(Ga,"&gt;").replace(Ha,"&quot;"):Ia.test(e)?(e.indexOf("&")!=-1&&(e=e.replace(Ea,"&amp;")),e.indexOf("<")!=-1&&(e=e.replace(Fa,"&lt;")),e.indexOf(">")!=-1&&(e=e.replace(Ga,"&gt;")),e.indexOf('"')!=-1&&(e=e.replace(Ha,"&quot;")),e):e}function Ja(e,t){for(var n=0,r=String(e).replace(/^[\s\xa0]+|[\s\xa0]+$/g,"").split("."),i=String(t).replace(/^[\s\xa0]+|[\s\xa0]+$/g,"").split("."),s=Math.max(r.length,i.length),o=0;n==0&&o<s;o++){var u=r[o]||"",a=i[o]||"",f=RegExp("(\\d*)(\\D*)","g"),l=RegExp("(\\d*)(\\D*)","g");do{var c=f.exec(u)||["","",""],h=l.exec(a)||["","",""];if(c[0].length==0&&h[0].length==0)break;n=Ka(c[1].length==0?0:parseInt(c[1],10),h[1].length==0?0:parseInt(h[1],10))||Ka(c[2].length==0,h[2].length==0)||Ka(c[2],h[2])}while(n==0)}return n}function Ka(e,t){return e<t?-1:e>t?1:0}function Oa(){return j.navigator?j.navigator.userAgent:null}function bb(e){return'<div class="label-gameover"><div>分数: <span class="stat">'+Da(String(e.f))+'</span></div><div>关数: <span class="stat">'+Da(String(e.h))+"</span></div>"+'</div><div class="button-replay button-big">重新再来</div><div class="button-quit button-big">Main Menu</div>'}function cb(e){var t='<div class="scoremenu">';e=e.Ca;var n=e.length;if(n>0)for(var r=0;r<n;r++){var i=e[r];t+='<div class="'+(r==0?"label-highscore":"")+'">'+Da(String(i.f))+" pts, "+Da(String(i.ha))+"</div>"}else t+=" <div>No scores recorded yet!</div>";return t+='<div class="button-back button-big">Back</div></div>',t}function X(e,t){this.color=e,this.coords=t}function db(){this.D={}}function eb(e){e.k=[],e.ba=!0;var t=o()*Y.length;e.Q=Y[t|0],e.ca=0,e.f=0,e.h=1,e.dispatchEvent(7),e.dispatchEvent(6),fb(e)}function gb(e){if(e.ba&&!hb(e,0,1)){for(var t=0;t<e.b.coords.length;++t){var n=e.b.coords[t];e.k[(e.b.y+n[1])*10+(e.b.x+n[0])]=!0}e.dispatchEvent(2,e.b),t=[],n=0;e:for(;n<e.b.coords.length;++n){var r=e.b.y+e.b.coords[n][1];if(!(t.indexOf(r)>=0)){for(var i=0;i<10;++i)if(!e.k[r*10+i])continue e;q(t,r)}}if(t.length){t.sort();for(n=0;n<t.length;++n)for(r=t[n];r>0;){for(i=0;i<10;++i)e.k[r*10+i]=e.k[(r-1)*10+i];--r}t.reverse(),n=t.length,e.f+=e.h*[40,100,300,1200][n-1],e.ca+=n,n=1+(e.ca/4|0),n!=e.h&&(e.h=n,e.dispatchEvent(7)),e.dispatchEvent(5,t),e.dispatchEvent(6)}fb(e)}}function jb(e){for(;ib(e,e.b);)e.b.y+=1;e.b.y-=1,e.dispatchEvent(1,e.b),gb(e)}function hb(e,t,n){for(var r=e.b.x+t,i=e.b.y+n,s=0;s<e.b.coords.length;++s){var o=e.b.coords[s];if(r+o[0]<0||r+o[0]>=10||i+o[1]<0||i+o[1]>=20||e.k[(i+o[1])*10+(r+o[0])])return!1}return e.b.x=r,e.b.y=i,e.dispatchEvent(0,e.b,t,n),!0}function ib(e,t){for(var n=0;n<t.coords.length;++n){var r=t.coords[n];if(t.x+r[0]<0||t.x+r[0]>=10||t.y+r[1]<0||t.y+r[1]>=20||e.k[(t.y+r[1])*10+(t.x+r[0])])return!1}return!0}function fb(e){e.b=e.Q,e.b.x=5,e.b.y=2;var t=o()*Y.length;e.Q=Y[t|0],ib(e,e.b)?e.dispatchEvent(4,e.b,e.Q):(e.ba=!1,e.dispatchEvent(8))}function kb(e){var t=r("block");return t.style.backgroundPosition=-Z*e+"px 0",t}function lb(){y.call(this),this.k=[],this.v=new y,A(this,this.v),this.e($,0,k(this.ua,this)),this.e($,1,k(this.ta,this)),this.e($,4,k(this.N,this)),this.e($,5,k(this.xa,this)),this.e($,3,k(this.wa,this)),this.e($,2,k(this.va,this))}function nb(e,t){t=t||Date.now();var n=t-e;return n<6e4?"just now":n<12e4?"one minute ago":n<36e5?Math.round(n/6e4)+" minutes ago":n<54e5?"one hour ago":n<864e5?Math.round(n/36e5)+" hours ago":n<1728e5?"yesterday":n<2592e6?Math.round(n/864e5)+" days ago":n<3888e6?"one month ago":n<31104e6?Math.round(n/2592e6)+" months ago":n<62208e6?"one year ago":Math.round(n/31104e6)+" years ago"}function ob(e){O.call(this,"transition"),this.aa=e}function pb(e){O.call(this,"mainmenu"),this.ga=e}function qb(e,t){var n=new y(s('<div class="mainmenu"><div class="button-play button-big">开始游戏</div></div>'));z(e,n);var r=n.element.offsetHeight;if(t||e.ga)w(n,-r),n.c(oa(0,0,.5));var i=new V(n.element.querySelector(".button-play"));i.n=function(){var e=m,t=new rb;w(t.d,416);var n=new ob(t);q(n.u,e),n.c(new U([new R([H(0,-416,1,e.d),G("opacity","0.2",.5,e.d),H(0,0,1,t.d)]),new P(function(){n.complete()})])),K(n)},i.p(e),i=new V(n.element.querySelector(".button-scores")),i.n=function(){n.c(new U([oa(0,-r,.5),new P(function(){var e=n.g;n.j(),sb(e)})]))},i.p(e),i=new V(n.element.querySelector(".button-more")),i.n=function(){window.location="https://aduros.com/games"},i.p(e)}function sb(e){var t;if("scores"in n){var r=Date.now();t=n.scores.map(function(e){return{f:e.score,ha:nb(e.date,r)}})}else t=[];var i=new y(s(cb({Ca:t})));z(e,i);var o=i.element.offsetHeight;t=new V(i.element.querySelector(".button-back")),t.n=function(){i.c(new U([oa(0,-o,.5),new P(function(){var e=i.g;i.j(),qb(e,!0)})]))},t.p(e),w(i,-o),i.c(oa(0,0,.5))}function tb(){var e=m,t=new pb(!0);w(t.d,-416);var n=new ob(t);return n.c(new U([new R([H(0,416,1,e.d),G("opacity","0.2",.5,e.d),H(0,0,1,t.d)]),new P(function(){n.complete()})])),n}function ub(){O.call(this,"pause")}function vb(){y.call(this,r("marquee")),this.label=new t(r("marquee-text")),A(this,this.label),this.element.style.setProperty("opacity","0","")}function wb(e,t){e.O(),ja(e.label,200),e.label.element.innerHTML=t,setTimeout(function(){var t=e.label.element.offsetWidth;e.c(new U([G("opacity","1",.5),H(-t,0,(t+200)/100,e.label),G("opacity","0",.5)]))},0)}function xb(){O.call(this,"gameover")}function mb(e){t.call(this);for(var n=0;n<e.coords.length;++n){var r=e.coords[n],i=kb(e.color);i.style.left=r[0]*Z+"px",i.style.top=r[1]*Z+"px",this.element.appendChild(i)}}function rb(){O.call(this,"playing")}function Bb(e){var t="";switch(e.type){case"mousedown":t="touchstart",zb=e.target;break;case"mousemove":if(!zb)return;t="touchmove";break;case"mouseup":t="touchend",Ab++}e={clientX:e.clientX,clientY:e.clientY,identifier:Ab,pageX:e.pageX,pageY:e.pageY,screenX:e.screenX,screenY:e.screenY,target:zb};var n=document.createEvent("UIEvent");n.initEvent(t,!0,!1),n.type=t,n.touches=t=="touchend"?[]:[e],n.targetTouches=t=="touchend"?[]:[e],n.changedTouches=[e],zb.dispatchEvent(n),t=="touchend"&&(zb=null)}function Hb(){(document.body.offsetWidth>320&&document.body.offsetHeight<416)&!(m instanceof Ca)&&K(new Ca)}var h,j=this;Math.floor(Math.random()*2147483648).toString(36);var m,da,n,o=Math.random;l(t,ia),t.prototype.detach=function(){this.parent?fa(this.parent.q,this)&&(this.parent=null,this.detach()):this.element.parentNode&&this.element.parentNode.removeChild(this.element)},t.prototype.j=function(){t.T.j.call(this),this.detach(),this.element=null},l(y,t),y.prototype.p=function(e){y.T.p.call(this,e);for(var t=0;t<this.q.length;++t)z(e,this.q[t],null)},y.prototype.j=function(){y.T.j.call(this);for(var e=0;e<this.q.length;++e){var t=this.q[e];t.parent=null,t.j()}};var la=0;B.prototype.s=g(),B.prototype.handleEvent=function(e){e.propertyName==this.l&&(this.t=2,e.target.removeEventListener("webkitTransitionEnd",this,!1))},B.prototype.update=function(e,t){t=this.S||t;switch(this.t){case 1:return this.m+=e,this.m>this.duration&&(this.m=this.duration),this.s(t),!1;case la:var n=window.getComputedStyle(t.element,null).getPropertyValue(this.l);return this.w(t),n!=t.element.style.getPropertyValue(this.l)?(this.t=1,ga(t.element.style,this.l,this.duration+"ms",this.Z),t.element.addEventListener("webkitTransitionEnd",this,!1),this.m=0,this.s(t),!1):!0;case 2:return this.t=la,ha(t.element.style,this.l),this.m=this.duration,this.s(t),!0}},B.prototype.stop=function(e){if(this.t==1){e=this.S||e;var t=window.getComputedStyle(e.element,null).getPropertyValue(this.l);ha(e.element.style,this.l),e.element.removeEventListener("webkitTransitionEnd",this,!1),e.element.style.setProperty(this.l,t,"")}},B.prototype.start=function(e){if(this.t==1){e=this.S||e;var t=window.getComputedStyle(e.element,null).getPropertyValue(this.l);this.w(e),t!=e.element.style.getPropertyValue(this.l)?(ga(e.element.style,this.l,this.duration-this.m+"ms",this.Z),e.element.addEventListener("webkitTransitionEnd",this,!1)):this.t=2}},l(ma,B),ma.prototype.w=function(e){e.element.style.setProperty(this.l,this.value,"")},l(D,B),D.prototype.w=function(e){this.B=e.x,this.C=e.y,e.x=this.x,e.y=this.y,v(e)},D.prototype.s=function(e){e.x=C(this,this.B,this.x),e.y=C(this,this.C,this.y)},l(E,B),E.prototype.w=function(e){this.B=e.x,this.C=e.y,this.V==null&&(this.V=this.ja+e.x,this.ea=this.ka+e.y),e.x=this.V,e.y=this.ea,v(e)},E.prototype.s=function(e){e.x=C(this,this.B,this.V),e.y=C(this,this.C,this.ea)},l(F,B),F.prototype.w=function(e){this.B=e.F,this.C=e.A,e.F=this.x,e.A=this.y,v(e)},F.prototype.s=function(e){e.F=C(this,this.B,this.x),e.A=C(this,this.C,this.y)},l(na,B),na.prototype.w=function(e){this.na=e.rotation,e.rotation+=this.rotation,v(e),this.Da=e.rotation},na.prototype.s=function(e){e.rotation=C(this,this.na,this.Da)},pa.prototype.addEventListener=function(e,t){var n=this.D[e];n==null?this.D[e]=[t]:q(n,t)},pa.prototype.removeEventListener=function(e,t){var n=this.D[e];n!=null&&fa(n,t)},pa.prototype.dispatchEvent=function(e){var t=this.D[e];if(t!=null){var n=Array.prototype.slice.apply(arguments);n.shift();for(var r=0;r<t.length;++r)t[r].apply(undefined,n)}},qa.prototype.e=function(e,t,n){q(this.L,new ra(e,t,n)),e.addEventListener(t,n,!1)},qa.prototype.G=function(){for(var e=0;e<this.L.length;++e){var t=this.L[e];t.ia.removeEventListener(t.la,t.oa,!1)}this.L=[]};var I=[],sa=document.getElementById("hydra-stage");h=ia.prototype,h.e=function(e,t,n){this.K||(this.K=new qa),this.K.e(e,t,n)},h.G=function(){this.K&&this.K.G()},h.c=function(e){this.a.length==0&&this.g!=null&&q(this.g.u,this),q(this.a,e),e.start(this)},h.O=function(){for(var e=0;e<this.a.length;++e){var t=this.a[e];t&&(t.stop(this),this.a[e]=null)}},h.p=function(e){this.g=e,this.a.length>0&&q(this.g.u,this)},h.update=function(e){for(var t=0;t<this.a.length;++t){var n=this.a[t];(!n||n.update(e,this))&&this.a.splice(t--,1)}return t==0},h.j=function(){this.O(),this.G(),this.g!=null&&(fa(this.g.entities,this),this.g=null)},h.r=function(){for(var e=0;e<this.a.length;++e){var t=this.a[e];t&&t.start(this)}},h.z=function(){for(var e=0;e<this.a.length;++e){var t=this.a[e];t&&t.stop(this)}},h=O.prototype,h.update=function(e){for(var t=0;t<this.u.length;++t){var n=this.u[t];(!n||n.update(e))&&this.u.splice(t--,1)}},h.load=g(),h.r=function(){for(var e=0;e<this.entities.length;++e)this.entities[e].r()},h.z=function(){for(var e=0;e<this.entities.length;++e)this.entities[e].z()},h.e=function(e,t,n){this.d.e(e,t,n)},h.G=function(){this.d.G()},h.c=function(e){this.d.c(e)},h.O=function(){this.d.O()},P.prototype.start=g(),P.prototype.stop=g(),P.prototype.update=function(e,t){return this.ma(e,t),!0},Q.prototype.start=g(),Q.prototype.stop=g(),Q.prototype.update=function(e){return this.m+=e,this.m>=this.Y?(this.m=0,!0):!1},R.prototype.stop=function(e){for(var t=0;t<this.a.length;++t){var n=this.a[t];n&&n.stop(e)}},R.prototype.start=function(e){for(var t=0;t<this.a.length;++t){var n=this.a[t];n&&n.start(e)}},R.prototype.update=function(e,t){for(var n=0;n<this.a.length;++n){var r=this.a[n];r&&r.update(e,t)&&(this.a[n]=null,q(this.H,r))}return this.H.length==this.a.length?(this.a=this.H,this.H=[],!0):!1},S.prototype.stop=function(e){this.U.stop(e)},S.prototype.start=function(e){this.U.start(e)},S.prototype.update=function(e,t){return this.U.update(e,t),!1},T.prototype.start=g(),T.prototype.stop=g(),T.prototype.update=function(e,t){return t.j(),!0},U.prototype.stop=function(e){this.o<this.a.length&&this.a[this.o].stop(e)},U.prototype.start=function(e){this.o<this.a.length&&this.a[this.o].start(e)},U.prototype.update=function(e,t){return this.a[this.o].update(e,t)?++this.o<this.a.length?(this.a[this.o].start(t),!1):(this.o=0,!0):!1};var Aa={'"':'\\"',"\\":"\\\\","/":"\\/","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","	":"\\t","":"\\u000b"},Ba=/\uffff/.test("￿")?/[\\\"\x00-\x1f\x7f-\uffff"]/g:/[\\\"\x00-\x1f\x7f-\xff]/g;"JSON"in window||(JSON={parse:va,stringify:wa}),"localStorage"in window||(localStorage={}),l(V,t),V.prototype.n=g(),V.prototype.handleEvent=function(e){if(m==this.g)switch(e.type){case"touchstart":var t=this.element;t.className?(" "+t.className+" ").indexOf(" button-down ")>=0||(t.className+=" button-down"):t.className="button-down";break;case"touchend":case"touchcancel":if(!e.targetTouches.length){t=this.element;var n=t.className.split(" "),r=n.indexOf("button-down");r>=0&&(n.splice(r,1),t.className=n.join(" ")),this.n()}}e.stopPropagation()},l(Ca,O),Ca.prototype.load=function(){this.d.element.appendChild(s("Rotate your device to play!")),this.e(window,"orientationchange",function(){document.body.offsetWidth>320&&document.body.offsetHeight<416||J()})};var Ea=/&/g,Fa=/</g,Ga=/>/g,Ha=/\"/g,Ia=/[&<>\"]/,W,La,Ma,Na;"ScriptEngine"in j&&j.ScriptEngine()=="JScript"&&(j.ScriptEngineMajorVersion(),j.ScriptEngineMinorVersion(),j.ScriptEngineBuildVersion()),Na=Ma=La=W=!1;var Pa;if(Pa=Oa()){var Qa=j.navigator;W=Pa.indexOf("Opera")==0,La=!W&&Pa.indexOf("MSIE")!=-1,Ma=!W&&Pa.indexOf("WebKit")!=-1,Na=!W&&!Ma&&Qa.product=="Gecko"}var Ra=La,Sa=Na,Ta=Ma,Ua;e:{var Va="",Wa;if(W&&j.opera){var Xa=j.opera.version;Va=typeof Xa=="function"?Xa():Xa}else{Sa?Wa=/rv\:([^\);]+)(\)|;)/:Ra?Wa=/MSIE\s+([^\);]+)(\)|;)/:Ta&&(Wa=/WebKit\/(\S+)/);if(Wa){var Ya=Wa.exec(Oa());Va=Ya?Ya[1]:""}}if(Ra){var Za,$a=j.document;Za=$a?$a.documentMode:undefined;if(Za>parseFloat(Va)){Ua=String(Za);break e}}Ua=Va}var ab={};!Ra||ab[9]||(ab[9]=Ja(Ua,"9")>=0),Ra&&(ab[9]||(ab[9]=Ja(Ua,"9")>=0));var Y=[new X(1,[[-1,-1],[-1,0],[0,0],[0,-1]]),new X(6,[[-2,0],[-1,0],[0,0],[1,0]]),new X(2,[[0,-1],[1,-1],[0,0],[-1,0]]),new X(0,[[0,-1],[-1,-1],[0,0],[1,0]]),new X(4,[[-1,-1],[-1,0],[0,0],[1,0]]),new X(3,[[1,-1],[-1,0],[0,0],[1,0]]),new X(5,[[0,-1],[-1,0],[0,0],[1,0]])];X.prototype.rotate=function(){if(this==Y[0])return null;for(var e=[],t=0;t<this.coords.length;++t){var n=this.coords[t];q(e,[-n[1],n[0]])}return e=new X(this.color,e),e.x=this.x,e.y=this.y,e},l(db,pa),db.prototype.rotate=function(){var e=this.b.rotate();e&&ib(this,e)&&(this.b=e,this.dispatchEvent(3,this.b))};var $;l(lb,y);var Z=20;h=lb.prototype,h.ua=function(e){x(this.v,Z*e.x,Z*e.y)},h.ta=function(){A(this,this.i),this.element.insertBefore(this.i.element,this.element.childNodes[0]),x(this.i,this.v.x,this.v.y);var e=this.i;e.A=10,v(e),this.i.element.style.opacity="0.2",this.i.c(new E(0,500,.5,"linear",p,void 0)),this.i.c(new U([G("opacity","0",.5),new T])),this.i=null},h.wa=function(e){this.N(e),e=this.i,e.rotation=-90,v(e),this.i.c(new na(90,.1,"linear",p,void 0))},h.va=function(e){for(var n=0;n<e.coords.length;++n){var r=e.coords[n],i=new t(kb(e.color)),s=e.x+r[0];r=e.y+r[1],this.k[r*10+s]=i,x(i,s*Z,r*Z),A(this,i)}},h.N=function(e){this.i&&this.i.j(),this.i=new mb(e),x(this.v,e.x*Z,e.y*Z),A(this.v,this.i)},h.xa=function(e){var n=[],i=new y;e.push(0);for(var s=[],o=0,u=e.length-1;o<u;++o){var a=e[o],f=new t(r("explosion"));x(f,0,a*Z),A(i,f);for(var l=0;l<10;++l)(f=this.k[a*10+l])&&q(n,f);a-=1;if(a>e[o+1]){l=Math.sqrt(o+1)/4;do{for(var c=0;c<10;++c)this.k[10*(a+o+1)+c]=this.k[10*a+c],(f=this.k[10*a+c])&&q(s,new D(f.x,(a+o+1)*Z,l,"ease-in",ea,f));--a}while(a>e[o+1])}}i.element.style.opacity="0",A(this,i),this.c(new U([G("opacity","0.8",.5,i),new P(function(){for(var e=0,t=n.length;e<t;++e)n[e].j();i.j()}),new R(s)]))},l(ob,O),ob.prototype.load=function(){var e=this.aa,t=0;t<0?(t+=I.length,t<0&&(t=0)):t>I.length&&(t=I.length),m&&I[t]==m&&(m.z(),m=e),I.splice(t,0,e),e.load(),m==e&&e.r()},ob.prototype.complete=function(){ta(this.aa)},l(pb,O),pb.prototype.load=function(){var e=new y;e.c(new S(new U([new P(function(){var t;t=o()*Y.length,t=Y[t|0];if(t!=Y[0]){var n=0,r;for(r=o()*4+0|0;n<r;++n)t=t.rotate()}t=new mb(t),n=o()*320+0,x(t,n|0,450),n=o()*4+1,ka(t,2/n),t.c(new U([new E(0,-480,n,"linear",p,void 0),new T])),A(e,t)}),new Q(.1)]))),qb(this,!1)},l(ub,O),ub.prototype.load=function(){var e=s('<div class="label-pause">PAUSED</div><div class="button-resume button-big">Continue</div><div class="button-quit button-big">Main Menu</div>');this.d.element.appendChild(e),x(this.d,-320,100),this.d.element.style.setProperty("opacity","0",""),this.c(H(0,100,.2)),this.c(G("opacity","1",.2));var t=this,n=new V(e.querySelector(".button-resume"));n.n=function(){t.c(new U([G("opacity","0",.2),new P(J)]))},z(this,n,null),e=new V(e.querySelector(".button-quit")),e.n=function(){J(),K(tb())},z(this,e,null)},l(vb,y),l(xb,O),xb.prototype.load=function(){n.lastGame=Date.now();var e=n.scores;e||(n.scores=e=[]);for(var t=0;t<e.length;++t)if(e[t].score<$.f)break;e.splice(t,0,{date:Date.now(),score:$.f}),e.length>10&&(e.length=10);try{localStorage["hydra:tetris"]=JSON.stringify(n)||null}catch(r){}e=s(bb({f:$.f,h:$.h,pa:t==0})),this.d.element.appendChild(e),x(this.d,320,100),this.d.element.style.setProperty("opacity","0",""),this.c(H(0,100,.2)),this.c(G("opacity","1",.2)),t=new V(e.querySelector(".button-replay")),t.n=function(){ta(new rb)},z(this,t,null),e=new V(e.querySelector(".button-quit")),e.n=function(){J(),K(tb())},z(this,e,null)},l(mb,t),l(rb,O),h=rb.prototype,h.load=function(){var e=s('<div class="ui-board"></div><div class="ui-preview"></div><div class="ui-score"></div><div class="ui-level"></div><div></div>');this.f=new t(e.querySelector(".ui-score")),z(this,this.f,null),this.Ea=e.querySelector(".ui-preview"),this.h=new t(e.querySelector(".ui-level")),z(this,this.h,null),this.d.element.appendChild(e);var r=new V;r.n=function(){K(new ub)},z(this,r,null),$=new db,e=e.querySelector(".ui-board"),this.M=new vb,w(this.M,40),"lastGame"in n||wb(this.M,yb?"":""),z(this,this.M,e),z(this,new lb,e),this.e($,8,k(this.qa,this)),this.e($,4,k(this.N,this)),this.e($,6,k(this.ya,this)),this.e($,7,k(this.sa,this)),this.e(window,"keydown",k(this.ra,this)),this.I=0,this.e(window,"touchstart",k(this.Ba,this)),this.e(window,"touchmove",k(this.Aa,this)),this.e(window,"touchend",k(this.za,this)),this.da=new Q(1),this.c(new S(new U([this.da,new P(function(){gb($)})]))),eb($)},h.qa=function(){K(new xb)},h.N=function(e,t){this.R&&this.R.j(),this.R=new mb(t),z(this,this.R,this.Ea)},h.ya=function(){this.f.element.textContent=String($.f),$.f>0&&(ka(this.f,2),this.f.c(new F(1,1,1,"ease-in",ea,void 0)))},h.sa=function(){this.da.Y=1e3/$.h,this.h.element.textContent="第 "+$.h+" 关",$.h>1&&(wb(this.M,"Level "+Da(String($.h))),ka(this.h,2),this.h.c(new F(1,1,1,"ease-in",ea,void 0)))},h.ra=function(e){if(m==this){switch(e.keyCode){case 27:K(new ub);break;case 37:hb($,-1,0);break;case 39:hb($,1,0);break;case 38:$.rotate();break;case 40:jb($);break;default:return}e.preventDefault()}},h.Ba=function(e){if(m==this){var t=e.touches[0];this.$=t.clientX,this.I=1,this.W=t.clientY,this.P=e.timeStamp,this.X=this.fa=null}},h.Aa=function(e){if(m==this){var t=e.touches[0];this.fa=this.W,this.X=this.P,this.W=t.clientY,this.P=e.timeStamp,e=t.clientX-this.$;if(e>Z)hb($,1,0);else{if(!(e<-Z))return;hb($,-1,0)}this.$=t.clientX,this.I=2}},h.za=function(){m==this&&(this.X&&(this.W-this.fa)/(this.P-this.X)>.25?jb($):this.I==1&&$.rotate(),this.P=this.I=0)};var yb="ontouchstart"in window,zb=null,Ab=0;yb||(document.addEventListener("mousemove",Bb,!0),document.addEventListener("mouseup",Bb,!0),document.addEventListener("mousedown",Bb,!0));var Cb;try{Cb=JSON.parse(localStorage["hydra:tetris"]||null)}catch(Db){Cb=null}n=Cb||{};var Eb=new pb(!1);K(Eb),da=Date.now(),setInterval(function(){var e=Date.now();m.update(e-da),da=e},1e3/30);var Fb=new O("intro"),Gb=new t(r("darkness"));Gb.c(new U([new ma("opacity","0",1,"ease-in",void 0),new P(J)])),z(Fb,Gb),K(Fb),window.addEventListener("orientationchange",Hb,!1),Hb(),window.addEventListener("resize",function(){window.setTimeout(window.scrollTo,0,1,0)},!1),document.addEventListener("touchstart",function(e){e.preventDefault(),window.scrollTo(0,1)},!0),window.scrollTo(0,1),"applicationCache"in window&&(applicationCache.addEventListener("updateready",applicationCache.swapCache,!1),applicationCache.status==2&&applicationCache.update())})();(function(){function t(e,t){for(var r=0,i=String(e).replace(/^[\s\xa0]+|[\s\xa0]+$/g,"").split("."),s=String(t).replace(/^[\s\xa0]+|[\s\xa0]+$/g,"").split("."),o=Math.max(i.length,s.length),u=0;r==0&&u<o;u++){var a=i[u]||"",f=s[u]||"",l=RegExp("(\\d*)(\\D*)","g"),c=RegExp("(\\d*)(\\D*)","g");do{var h=l.exec(a)||["","",""],p=c.exec(f)||["","",""];if(h[0].length==0&&p[0].length==0)break;r=n(h[1].length==0?0:parseInt(h[1],10),p[1].length==0?0:parseInt(p[1],10))||n(h[2].length==0,p[2].length==0)||n(h[2],p[2])}while(r==0)}return r}function n(e,t){return e<t?-1:e>t?1:0}function u(){return e.navigator?e.navigator.userAgent:null}function S(){var e=document.createElement("script");e.src="static/app-"+function(){if(p)return"webkit";if(h){if(t(d,"2.0b")>=0)return"ff4";if(t(d,"1.8")>=0)return"ff3"}else{if(c&&t(d,"9")>=0)return"ie9";if(l)return"opera"}return"unsupported"}()+".js",document.body.appendChild(e)}var e=this,r,i,s,o;o=s=i=r=!1;var a;if(a=u()){var f=e.navigator;r=a.indexOf("Opera")==0,i=!r&&a.indexOf("MSIE")!=-1,s=!r&&a.indexOf("WebKit")!=-1,o=!r&&!s&&f.product=="Gecko"}var l=r,c=i,h=o,p=s,d;e:{var v="",m;if(l&&e.opera){var g=e.opera.version;v=typeof g=="function"?g():g}else{h?m=/rv\:([^\);]+)(\)|;)/:c?m=/MSIE\s+([^\);]+)(\)|;)/:p&&(m=/WebKit\/(\S+)/);if(m){var y=m.exec(u());v=y?y[1]:""}}if(c){var b,w=e.document;b=w?w.documentMode:undefined;if(b>parseFloat(v)){d=String(b);break e}}d=v}var E=new Image;E.src="./static/chrome.jpg",E.onload=function(){S()}})();