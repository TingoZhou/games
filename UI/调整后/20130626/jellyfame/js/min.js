function UtilClass(){this.getXmlHttp=function(){var e;try{e=new XMLHttpRequest}catch(t){try{e=new ActiveXObject("Msxml2.XMLHTTP")}catch(t){try{e=new ActiveXObject("Microsoft.XMLHTTP")}catch(t){return alert("Your browser does not support AJAX!"),null}}}return e},this.xmlLoadUrl=function(e,t){var n=this.getXmlHttp();if(n==null)return!1;n.onreadystatechange=function(){n.readyState==4&&t&&t(n)},n.open("GET",e,!0),n.send(null)},this.xmlGetUrl=function(e){var t=this.getXmlHttp();return t==null?!1:(t.open("GET",e,!1),t.send(null),t.responseText)},this.getCookie=function(e){var t,n,r,i=document.cookie.split(";");for(t=0;t<i.length;t++){n=i[t].substr(0,i[t].indexOf("=")),r=i[t].substr(i[t].indexOf("=")+1),n=n.replace(/^\s+|\s+$/g,"");if(n==e)return unescape(r)}},this.setCookie=function(e,t,n){var r=new Date;r.setDate(r.getDate()+n);var i=escape(t)+(n==null?"":"; expires="+r.toUTCString());document.cookie=e+"="+i}}function JAction(){this.timePassed=0,this.stop=function(){scheduler.unSchedule(this),this.stoped()},this.stoped=function(){this.node.actionStopped(this)},this.start=function(e){this.timePassed=0,this.node=e,scheduler.schedule(this)},this.tick=function(e){this.timePassed+=e,this.timePassed>this.duration&&(e-=this.timePassed-this.duration),this.update(e),this.timePassed>=this.duration&&this.stop()}}function JSequence(e){this.extend(JAction),this.actions=e;var t=this;this.stop=function(){this.actions[this.nextAction-1].stoped=function(){},this.actions[this.nextAction-1].stop(),this.stoped()},this.start=function(e){this.nextAction=0,this.node=e,this.startNextAction()},this.startNextAction=function(){if(t.nextAction>=t.actions.length){t.stop();return}var e=t.actions[t.nextAction++];e.stoped=function(){t.startNextAction()},e.start(t.node)}}function JSpawn(e){this.extend(JAction),this.actions=e;var t=this;this.stop=function(){for(var e=0;e<this.actions.length;e++)this.actions[e].stop()},this.start=function(e){this.nextAction=0,this.node=e;for(var t=0;t<this.actions.length;t++)this.actions[t].start(e)}}function JRepeatForever(e){this.action=e;var t=this;e.stoped=function(){e.node.actionStopped(e),e.node.runAction(e)},this.stoped=function(){this.node.actionStopped(this)},this.stop=function(){this.action.stoped=function(){e.node.actionStopped(e)},this.action.stop(),this.stoped()},this.start=function(e){this.node=e,this.action.start(e)}}function JCallFunc(obj,func){this.stoped=function(){},this.stop=function(){this.stoped()},this.start=function(node){eval("obj."+func+"();"),this.stop()}}function JCallFuncO(obj,func,arg){this.stoped=function(){},this.stop=function(){this.stoped()},this.start=function(){eval("obj."+func+"(arg);"),this.stop()}}function JDelayTime(e){this.extend(JAction),this.duration=e,this.update=function(){}}function JMoveBy(e,t){this.extend(JAction),this.pos=t,this.duration=e,this.update=function(e){this.node.position.x+=this.pos.x*e/this.duration,this.node.position.y+=this.pos.y*e/this.duration}}function JMoveTo(e,t){this.extend(JAction),this.pos=t,this.duration=e,this.firstTime=!0,this.update=function(e){this.firstTime&&(this.pos=ccp(this.pos.x-this.node.position.x,this.pos.y-this.node.position.y),this.firstTime=!1),this.node.position.x+=this.pos.x*e/this.duration,this.node.position.y+=this.pos.y*e/this.duration}}function JScaleTo(e,t){this.extend(JAction),this.scale=t,this.duration=e,this.firstTime=!0,this.update=function(e){this.firstTime&&(this.scale=this.scale-this.node.scale,this.firstTime=!1),this.node.scale+=this.scale*e/this.duration}}function JRotateBy(e,t){this.extend(JAction),this.rotation=t,this.duration=e,this.update=function(e){this.node.rotation+=this.rotation*e/this.duration}}function JFadeTo(e,t){this.extend(JAction),this.opacity=t,this.duration=e,this.firstTime=!0,this.update=function(e){this.firstTime&&(this.opacity=this.opacity-this.node.opacity,this.firstTime=!1),this.node.opacity+=this.opacity*e/this.duration,this.node.opacity<0&&(this.node.opacity=0)}}function JFadeIn(e){this.extend(JFadeTo),this.opacity=1,this.duration=e}function JFadeOut(e){this.extend(JFadeTo),this.opacity=0,this.duration=e}function SchedulerClass(){this.sched=[],this.schedule=function(e){this.sched.push(e)},this.unSchedule=function(e){for(var t=0;t<this.sched.length;t++)if(this.sched[t]==e){this.sched.splice(t,1);return}},this.update=function(e){for(var t=0;t<this.sched.length;t++)this.sched[t].tick(e)}}function ccp(e,t){return{x:e,y:t}}function ccs(e,t){return{width:e,height:t}}function ccc4(e,t,n,r){function i(e,t,n,r){this.r=e,this.g=t,this.b=n,this.a=r,this.getFillStyle=function(){return"rgba("+e+","+t+","+n+","+r+")"}}return new i(e,t,n,r)}function ContentLoader(){var e=this;this.loading=!0,this.itemCount=10,this.loadingCount=0,this.loadedCount=0,this.imgs=[],this.addImage=function(e){for(var t=0;t<this.imgs.length;t++)if(this.imgs[t]==e)return;this.loadingCount++,this.imgs.push(e)},this.preloadImages=function(t){if(this.loading==0)return;for(var n=0;n<t.length;n++){var r=new Image;this.addImage(r),r.onload=function(){e.itemLoaded()},r.src="img/"+t[n]}},this.itemLoaded=function(){if(this.loading==0)return;this.loadedCount++,this.loadedCount==this.loadingCount&&this.finishedLoading(),this.itemCount<this.loadingCount&&(this.itemCount=this.loadingCount),this.setPercentage(this.loadedCount/this.itemCount)},this.stopLoading=function(){this.loading=!1},this.setPercentage=function(){}}function Node(){this.position={x:0,y:0},this.size={width:0,height:0},this.rotation=0,this.scaleDual={x:1,y:1},this.scale=1,this.children=[],this.parent=null,this.update=null,this.isMouseEnabled=!1,this.visible=!0,this.zIndex=0,this.opacity=1,this.actions=[],this.draw=function(e){this.update!=null&&this.update(e);if(!this.visible)return;ctx.save(),ctx.translate(this.position.x,-this.position.y),ctx.rotate(this.rotation*TO_RAD),ctx.scale(this.scaleDual.x*this.scale,this.scaleDual.y*this.scale),ctx.globalAlpha=this.opacity,this.visit();for(var t=0;t<this.children.length;t++)this.children[t].draw(e);ctx.restore()},this.internalUpdateLayout=function(){this.updateLayout&&this.updateLayout();for(var e=0;e<this.children.length;e++)this.children[e].internalUpdateLayout&&this.children[e].internalUpdateLayout()},this.addChild=function(e){if(e.parent!=null){alert("child allready added");return}this.children.push(e),e.parent=this},this.addChildZ=function(e,t){if(e.parent!=null){alert("child allready added");return}e.zIndex=t;for(var n=0;n<this.children.length;n++)if(this.children[n].zIndex>t){this.children.splice(n,0,e),e.parent=this;return}this.children.push(e),e.parent=this;return},this.getAbsolutePosition=function(e){var t=ccp(0,0),n=this;while(n!=null)t.x+=n.position.x,t.y+=n.position.y,n=n.parent;return e?(e=ccp(e.x,e.y),e.x-=t.x,e.y-=t.y,e):t},this.propagateMouseDown=function(e){if(this.isMouseEnabled){var t=!1;for(var n=0;n<this.children.length;n++)this.children[n].propagateMouseDown(e)&&(t=!0);return t||this.mouseDown&&this.mouseDown(e),!0}return!1},this.propagateMouseUp=function(e){if(this.isMouseEnabled){var t=!1;for(var n=0;n<this.children.length;n++)this.children[n].propagateMouseUp(e)&&(t=!0);return t||this.mouseUp&&this.mouseUp(e),!0}return!1},this.propagateMouseOut=function(e){if(this.isMouseEnabled){var t=!1;for(var n=0;n<this.children.length;n++)this.children[n].propagateMouseOut(e)&&(t=!0);return t||this.mouseOut&&this.mouseOut(e),!0}return!1},this.propagateMouseMove=function(e){if(this.isMouseEnabled){var t=!1;for(var n=0;n<this.children.length;n++)this.children[n].propagateMouseMove(e)&&(t=!0);return t||this.mouseMove&&this.mouseMove(e),!0}return!1},this.runAction=function(e){this.actions.push(e),e.start(this),this.actions.length>30&&alert("probably stop action error length "+this.actions.lenght)},this.actionStopped=function(e){for(var t=0;t<this.actions.length;t++)if(this.actions[t]==e){this.actions.splice(t,1);break}},this.stopActionByTag=function(e){for(var t=0;t<this.actions.length;t++)this.actions[t].tag==e&&(this.actions[t].stop(),t--)},this.stopAllActions=function(){for(var e=this.actions.length-1;e>=0;e--)this.actions[e].stop()},this.visit=function(){}}function Sprite(e){this.extend(Node),this.file=e,this.image=new Image;var t=this;this.init=function(){this.image.onload=this.imageLoaded,this.file&&(engine.loader.addImage(this),this.image.src="img/"+this.file)},this.imageLoaded=function(){engine.loader.itemLoaded(),t.size=ccs(this.width,this.height)},this.visit=function(){ctx.drawImage(this.image,-this.size.width/2,-this.size.height/2)},this.setFile=function(e){engine.loader.addImage(this),this.file="img/"+e,this.image.src="img/"+e},this.init()}function SpriteCutOutHeight(e){this.extend(Sprite),this.file=e,this.cutHeight=0,this.visit=function(){if(this.size.height==0)return;this.cutHeight>this.size.height-1&&(this.cutHeight=this.size.height-1),this.cutHeight<1&&(this.cutHeight=1),ctx.drawImage(this.image,0,this.cutHeight,this.size.width,this.size.height-this.cutHeight,-this.size.width/2,-this.size.height/2+this.cutHeight,this.size.width,this.size.height-this.cutHeight)},this.init()}function JLabel(e,t,n,r){this.extend(Node),this.text=e,this.fontName=t,this.fontSize=n,this.color=JWhite,this.strokeColor=JBlack,this.stroke=0,this.strokeStyle=this.strokeColor.getFillStyle(),this.fillStyle=this.color.getFillStyle(),this.init=function(){r&&(this.stroke=r);if(this.fontName==""||this.fontName=="defaultFont")this.fontName="defaultFont";ctx.font=this.fontSize+"pt "+this.fontName,this.updateSize()},this.visit=function(){ctx.font=this.fontSize+"pt "+this.fontName,this.stroke>0&&(ctx.lineWidth=this.stroke*2,ctx.strokeStyle=this.strokeStyle,ctx.strokeText(this.text,-this.size.width/2,this.size.height/2)),ctx.fillStyle=this.fillStyle,ctx.fillText(this.text,-this.size.width/2,this.size.height/2)},this.updateLayout=function(){this.updateSize()},this.updateSize=function(){ctx.font=this.fontSize+"pt "+this.fontName,this.size=ccs(ctx.measureText(this.text).width+this.stroke*0,this.fontSize+this.stroke*0)},this.setText=function(e){this.text=e,this.updateSize()},this.init()}function JMenuItemImage(normal,selected,target,func){this.extend(Sprite),this.selectedImg=selected,this.normalImg=normal,this.target=target,this.func=func,this.enabled=!0,this.init=function(){this.normalImg&&this.setFile(this.normalImg)},this.select=function(){this.selectedImg&&this.setFile(this.selectedImg)},this.deSelect=function(){this.normalImg&&this.setFile(this.normalImg)},this.clicked=function(){eval("this.target."+this.func+"()")},this.isInside=function(e){return this.position.x-this.size.width/2<=e.x&&this.position.x+this.size.width/2>=e.x&&this.position.y-this.size.height/2<=e.y&&this.position.y+this.size.height/2>=e.y?!0:!1},this.init()}function JMenu(e){this.extend(Node),this.isMouseEnabled=!0;if(e)for(var t=0;t<e.length;t++)this.addChild(e[t]);this.mouseDown=function(e){e=this.getAbsolutePosition(e);for(var t=this.children.length-1;t>=0;t--)if(this.children[t].enabled&&this.children[t].isInside&&this.children[t].isInside(e)){this.selected=this.children[t],this.children[t].select();break}},this.mouseUp=function(e){e=this.getAbsolutePosition(e);for(var t=this.children.length-1;t>=0;t--)if(this.children[t].enabled&&this.children[t].isInside&&this.children[t].isInside(e)){this.children[t].clicked();break}this.selected&&this.selected.deSelect(),this.selected=null}}function EngineClass(){this.scene=null,this.size={width:0,height:0},this.preloaderScene=null,this.fps=100;var e=this;this.setCanvas=function(e){this.canvas=e,ctx=this.canvas.getContext("2d"),this.size.width=e.width,this.size.height=e.height,this.canvas.onmousedown=this.mouseDown,this.canvas.onmouseup=this.mouseUp,this.canvas.onmouseout=this.mouseOut,this.canvas.onmousemove=this.mouseMove,document.addEventListener("touchstart",this.touchHandler,!0),document.addEventListener("touchmove",this.touchHandler,!0),document.addEventListener("touchend",this.touchHandler,!0),document.addEventListener("touchcancel",this.touchHandler,!0),window.onload=this.onLoad},this.setScene=function(e){this.scene=e},this.setPreloaderScene=function(e){this.preloaderScene=e},this.removePreloaderScene=function(){this.preloaderScene=null},this.updateLayout=function(){this.scene!=null&&this.scene.internalUpdateLayout()},this.onLoad=function(){},this.redraw=function(e){ctx!=null&&ctx.fillRect(0,0,engine.size.width,engine.size.height),this.scene!=null&&(ctx.translate(0,this.size.height),this.scene.draw(e),ctx.translate(0,-this.size.height)),this.preloaderScene!=null&&(ctx.translate(0,this.size.height),this.preloaderScene.draw(e),ctx.translate(0,-this.size.height))};var t=(new Date).getTime();this.loop=function(){var n=(new Date).getTime();scheduler.update((n-t)*.001),e.redraw((n-t)*.001),t=n,setTimeout("engine.loop()",1e3/this.fps)},this.getOffsetPosition=function(e){var t=0,n=0;if(!e)return{x:0,y:0};while(e.offsetParent)t+=e.offsetLeft,e.style.marginLeft&&(t-=parseInt(e.style.marginLeft)),e.style.paddingLeft&&(t-=parseInt(e.style.paddingLeft)),e.style.margin&&(t-=parseInt(e.style.margin)),e.style.padding&&(t-=parseInt(e.style.padding)),n+=e.offsetTop,e.style.marginTop&&(n-=parseInt(e.style.marginTop)),e.style.paddingTop&&(n-=parseInt(e.style.paddingTop)),e.style.margin&&(n-=parseInt(e.style.margin)),e.style.padding&&(n-=parseInt(e.style.padding)),e=e.offsetParent;return t+=e.offsetLeft,n+=e.offsetTop,{x:t,y:n}},this.getMousePosition=function(e){var t=0,n=0;if(!e)var e=window.event;if(e.pageX||e.pageY)t=e.pageX,n=e.pageY;else if(e.clientX||e.clientY)t=e.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,n=e.clientY+document.body.scrollTop+document.documentElement.scrollTop;var r=this.getOffsetPosition(this.canvas);return t-=r.x,n-=r.y,n=engine.size.height-n,{x:t,y:n}},this.mouseDown=function(t){if(!t)var t=window.event;e.preloaderScene!=null?e.preloaderScene.propagateMouseDown(e.getMousePosition(t)):e.scene!=null&&e.scene.propagateMouseDown(e.getMousePosition(t))},this.mouseUp=function(t){if(!t)var t=window.event;e.preloaderScene!=null?e.preloaderScene.propagateMouseUp(e.getMousePosition(t)):e.scene!=null&&e.scene.propagateMouseUp(e.getMousePosition(t))},this.mouseOut=function(t){if(!t)var t=window.event;e.scene!=null&&e.scene.propagateMouseOut(e.getMousePosition(t))},this.mouseMove=function(t){if(!t)var t=window.event;e.preloaderScene!=null?e.preloaderScene.propagateMouseMove(e.getMousePosition(t)):e.scene!=null&&e.scene.propagateMouseMove(e.getMousePosition(t))},this.touchHandler=function(e){var t=e.changedTouches,n=t[0],r="";switch(e.type){case"touchstart":r="mousedown";break;case"touchmove":r="mousemove";break;case"touchend":r="mouseup";break;default:return}var i=document.createEvent("MouseEvent");i.initMouseEvent(r,!0,!0,window,1,n.screenX,n.screenY,n.clientX,n.clientY,!1,!1,!1,!1,0,null),n.target.dispatchEvent(i);if(e.type=="touchend"){var s=document.createEvent("MouseEvent");s.initMouseEvent("mouseout",!0,!0,window,1,n.screenX,n.screenY,n.clientX,n.clientY,!1,!1,!1,!1,0,null),n.target.dispatchEvent(s)}e.preventDefault()},this.loader=new ContentLoader,this.loader.finishedLoading=function(){e.loader.stopLoading(),setTimeout(function(){e.updateLayout()},10),setTimeout(function(){e.updateLayout()},100),setTimeout(function(){window.scrollTo(0,1)},0)},this.log=function(e,t,n){},this.loop()}function Ball(e,t){this.extend(Sprite),this.color=0,this.suffix="",e&&(this.color=e),t&&(this.suffix=t),this.init=function(){this.setFile("balls/ball-"+this.color+this.suffix+".png")},this.setColor=function(e){this.color=e,this.setFile("balls/ball-"+this.color+this.suffix+".png")},this.setSuffix=function(e){this.suffix=e,this.setFile("balls/ball-"+this.color+this.suffix+".png")},this.init()}function CircleMini(e,t){this.extend(Node),this.circleCounts=[1,6,12,18],this.firstCircleRadius=45,this.radius=e,this.suffix=t,this.init=function(){var e="-mini"+this.suffix;this.balls=[];for(var t=0;t<4;t++){this.balls[t]=[];for(var n=0;n<this.circleCounts[t];n++)this.balls[t][n]=new Ball(2,e),this.addChild(this.balls[t][n]),t>0&&(this.balls[t][n].position=ccp(parseInt(t*this.radius*Math.cos(n*2*3.14159/this.circleCounts[t])),parseInt(t*this.radius*Math.sin(n*2*3.14159/this.circleCounts[t])))),this.balls[t][n].scale=1.1}},this.loadLevel=function(e){for(var t=0;t<this.balls.length;t++)for(var n=0;n<this.balls[t].length;n++)this.balls[t][n].setColor(e.finishOrder[t][n])},this.init()}function Circle(){this.extend(Node),this.balls=[],this.circleCounts=[1,6,12,18],this.firstCircleRadius=45,this.horizontalDrift=0,this.h60Drift=0,this.v60Drift=0,this.h120Drift=0,this.v120Drift=0,this.firstCircleAngle=0,this.secondCircleAngle=0,this.thirdCircleAngle=0,this.firstCircleAngleAnimating=!1,this.secondCircleAngleAnimating=!1,this.thirdCircleAngleAnimating=!1,this.horizontalAnimating=!1,this.v60Animating=!1,this.v120Animating=!1,this.ballField=0,this.constantHorizontalUnit,this.constantV60Unit,this.constantH60Unit,this.constantRotationUnit,this.init=function(){this.ballField=32+(this.firstCircleRadius-64)/2;for(var e=0;e<4;e++){var t=this.circleCounts[e];this.balls[e]=[];for(var n=0;n<t;n++){var r=new Ball;r.setColor(1),this.balls[e][n]=r,this.addChild(r)}}this.updatePositions()},this.stopAllAnimation=function(){this.firstCircleAngleAnimating=!1,this.firstCircleAngle=0,this.secondCircleAngleAnimating=!1,this.secondCircleAngle=0,this.thirdCircleAngleAnimating=!1,this.thirdCircleAngle=0,this.horizontalAnimating=!1,this.horizontalDrift=0,this.v60Animating=!1,this.v60Drift=0,this.h60Drift=0,this.v120Animating=!1,this.v120Drift=0,this.h120Drift=0,this.updatePositions()},this.updatePositions=function(){this.balls[0][0].position=ccp(0+this.horizontalDrift+this.h60Drift+this.h120Drift,0+this.v60Drift+this.v120Drift);for(var e=0;e<this.circleCounts[1];e++){var t=Math.cos(e*2*3.14159/this.circleCounts[1]+this.firstCircleAngle)*this.firstCircleRadius,n=Math.sin(e*2*3.14159/this.circleCounts[1]+this.firstCircleAngle)*this.firstCircleRadius;e%3==0&&(t+=this.horizontalDrift),e%3==1&&(t+=this.h60Drift,n+=this.v60Drift),e%3==2&&(t+=this.h120Drift,n+=this.v120Drift),this.balls[1][e].position=ccp(t,n)}for(var e=0;e<this.circleCounts[2];e++){var t=Math.cos(e*2*3.14159/this.circleCounts[2]+this.secondCircleAngle)*2*this.firstCircleRadius,n=Math.sin(e*2*3.14159/this.circleCounts[2]+this.secondCircleAngle)*2*this.firstCircleRadius;e%6==0&&(t+=this.horizontalDrift),e%6==2&&(t+=this.h60Drift,n+=this.v60Drift),e%6==4&&(t+=this.h120Drift,n+=this.v120Drift),this.balls[2][e].position=ccp(t,n)}for(var e=0;e<this.circleCounts[3];e++){var t=Math.cos(e*2*3.14159/this.circleCounts[3]+this.thirdCircleAngle)*3*this.firstCircleRadius,n=Math.sin(e*2*3.14159/this.circleCounts[3]+this.thirdCircleAngle)*3*this.firstCircleRadius;e%9==0&&(t+=this.horizontalDrift),e%9==3&&(t+=this.h60Drift,n+=this.v60Drift),e%9==6&&(t+=this.h120Drift,n+=this.v120Drift),this.balls[3][e].position=ccp(t,n)}},this.update=function(e){this.horizontalAnimating||this.v60Animating||this.v120Animating||this.firstCircleAngleAnimating||this.secondCircleAngleAnimating||this.thirdCircleAngleAnimating;var t=this.constantHorizontalUnit*e,n=this.constantV60Unit*e,r=this.constantH60Unit*e,i=n,s=r,o=this.constantRotationUnit*e;this.horizontalAnimating&&(this.horizontalDrift<=t&&this.horizontalDrift>=-t?(this.horizontalAnimating=!1,this.horizontalDrift=0):this.horizontalDrift>0?this.horizontalDrift-=t:this.horizontalDrift+=t),this.v60Animating&&(this.v60Drift<=n&&this.v60Drift>=-n?(this.v60Animating=!1,this.v60Drift=0,this.h60Drift=0):this.v60Drift>0?(this.v60Drift-=n,this.h60Drift-=r):(this.v60Drift+=n,this.h60Drift+=r)),this.v120Animating&&(this.v120Drift<=i&&this.v120Drift>=-i?(this.v120Animating=!1,this.v120Drift=0,this.h120Drift=0):this.v120Drift>0?(this.v120Drift-=i,this.h120Drift+=s):(this.v120Drift+=i,this.h120Drift-=s)),this.firstCircleAngleAnimating&&(this.firstCircleAngle<=o&&this.firstCircleAngle>=-o?(this.firstCircleAngleAnimating=!1,this.firstCircleAngle=0):this.firstCircleAngle>0?this.firstCircleAngle-=o:this.firstCircleAngle+=o),this.secondCircleAngleAnimating&&(this.secondCircleAngle<=o&&this.secondCircleAngle>=-o?(this.secondCircleAngleAnimating=!1,this.secondCircleAngle=0):this.secondCircleAngle>0?this.secondCircleAngle-=o:this.secondCircleAngle+=o),this.thirdCircleAngleAnimating&&(this.thirdCircleAngle<=o&&this.thirdCircleAngle>=-o?(this.thirdCircleAngleAnimating=!1,this.thirdCircleAngle=0):this.thirdCircleAngle>0?this.thirdCircleAngle-=o:this.thirdCircleAngle+=o),this.updatePositions()},this.loadLevel=function(e){for(var t=0;t<this.balls.length;t++)for(var n=0;n<this.balls[t].length;n++)this.balls[t][n].setColor(e.startOrder[t][n])},this.isEqualToColors=function(e){for(var t=0;t<this.balls.length;t++)for(var n=0;n<this.balls[t].length;n++)if(this.balls[t][n].color!=e[t][n])return!1;return!0},this.init()}function TouchableCircle(){this.extend(Circle),this.selectedBall=null,this.currentMove=0,this.isMouseEnabled=!0,this.moveHistory=[],this.circleDelegate=null,this.currentDelay=0,this.init=function(){this.pathSelected=new Sprite("pathsSelected-first.png"),this.pathSelected.visible=!1,this.addChildZ(this.pathSelected,-1)},this.normalizeAngle=function(e,t,n){return t<0&&n>0&&(e+=3.14159),t<0&&n<=0&&(e-=3.14159),e>6.28318&&(e-=6.28318),e<-6.28318&&(e+=6.28318),e},this.distanceFromLine=function(e,t){return Math.abs(e*t.x-t.y)/Math.sqrt(Math.pow(e,2)+1)},this.calculateOnLineDistance=function(e,t){var n=Math.atan(e),r=t.x*Math.cos(-n)-t.y*Math.sin(-n),i=this.startPos.x*Math.cos(-n)-this.startPos.y*Math.sin(-n);return e>0?r-i:i-r},this.setSelectedPath=function(e){var t=0;if(this.selected=="first")for(var n=0;n<this.balls[1].length;n++){var r=this.balls[1][n];r.color!=0&&t++,r.setSuffix("-white")}else if(this.selected=="second")for(var n=0;n<this.balls[2].length;n++){var r=this.balls[2][n];r.color!=0&&t++,r.setSuffix("-white")}else if(this.selected=="third")for(var n=0;n<this.balls[3].length;n++){var r=this.balls[3][n];r.color!=0&&t++,r.setSuffix("-white")}else if(this.selected=="horizontal"){var i=this.balls,s=[i[0][0],i[1][0],i[1][3],i[2][0],i[2][6],i[3][0],i[3][9]];for(var n=0;n<s.length;n++){var r=s[n];r.color!=0&&t++,r.setSuffix("-white")}}else if(this.selected=="60"){var i=this.balls,s=[i[0][0],i[1][1],i[1][4],i[2][2],i[2][8],i[3][3],i[3][12]];for(var n=0;n<s.length;n++){var r=s[n];r.color!=0&&t++,r.setSuffix("-white")}}else if(this.selected=="120"){var i=this.balls,s=[i[0][0],i[1][2],i[1][5],i[2][4],i[2][10],i[3][6],i[3][15]];for(var n=0;n<s.length;n++){var r=s[n];r.color!=0&&t++,r.setSuffix("-white")}}if(t==0){this.pathDeselected(),this.selected="nil";return}e=="60"?(e="horizontal",this.pathSelected.rotation=-60):e=="120"?(e="horizontal",this.pathSelected.rotation=-120):this.pathSelected.rotation=0;var o="pathsSelected-"+e+".png";this.pathSelected.setFile(o),this.pathSelected.position=ccp(0,0),this.pathSelected.visible=!0},this.selectBall=function(e){var t=Math.atan(e.y/e.x);t=this.normalizeAngle(t,e.x,e.y);var n=Math.sqrt(Math.pow(e.x,2)+Math.pow(e.y,2)),r=null;n>=this.ballField&&n<this.ballField+this.firstCircleRadius?r=this.balls[1]:n>=this.ballField+this.firstCircleRadius&&n<2*this.firstCircleRadius+this.ballField?r=this.balls[2]:n>=2*this.firstCircleRadius+this.ballField&&n<3*this.firstCircleRadius+this.ballField&&(r=this.balls[3]);if(r!=null){var i=r.length,s=6.28318/i;t<=-s/2&&(t=6.28318+t),this.selectedBall=r[parseInt((t+s/2)/s)]}else n<this.ballField?this.selectedBall=this.balls[0][0]:this.selectedBall=null;this.selectedBall!=null&&this.selectedBall.color!=0&&this.selectedBall.setSuffix("-white")},this.selectMethod=function(e){var t=Math.sqrt(Math.pow(e.x,2)+Math.pow(e.y,2)),n=Math.sqrt(Math.pow(this.startPos.x,2)+Math.pow(this.startPos.y,2)),r=Math.sqrt(Math.pow(e.x-this.startPos.x,2)+Math.pow(e.y-this.startPos.y,2)),i=this.distanceFromLine(Math.sqrt(3),e),s=this.distanceFromLine(Math.sqrt(3),ccp(e.x+(this.startPos.y/Math.sqrt(3)-this.startPos.x),e.y)),o=this.distanceFromLine(-Math.sqrt(3),e),u=this.distanceFromLine(-Math.sqrt(3),ccp(e.x+(this.startPos.y/-Math.sqrt(3)-this.startPos.x),e.y)),a=this.calculateOnLineDistance(Math.sqrt(3),e),f=this.calculateOnLineDistance(-Math.sqrt(3),e);if("notsure60"==this.selected)r>10*iPadMultiplier&&(n<this.ballField?Math.abs(a)>Math.abs(f)&&Math.abs(a)>Math.abs(e.x-this.startPos.x)?this.selected="60":Math.abs(f)>Math.abs(a)&&Math.abs(f)>Math.abs(e.x-this.startPos.x)?this.selected="120":this.selected="horizontal":s<Math.abs(a)?this.selected="60":n>=this.ballField&&n<this.ballField+this.firstCircleRadius?this.selected="first":n>=this.ballField+this.firstCircleRadius&&n<2*this.firstCircleRadius+this.ballField?this.selected="second":n>=2*this.firstCircleRadius+this.ballField&&n<3*this.firstCircleRadius+this.ballField?this.selected="third":this.selected="none",this.startAngle=Math.atan(e.y/e.x),this.startAngle=this.normalizeAngle(this.startAngle,e.x,e.y),this.startPos.x=e.x,this.startPos.y=e.y);else if("notsure120"==this.selected)r>10*iPadMultiplier&&(u<Math.abs(f)?this.selected="120":n>=this.ballField&&n<this.ballField+this.firstCircleRadius?this.selected="first":n>=this.ballField+this.firstCircleRadius&&n<2*this.firstCircleRadius+this.ballField?this.selected="second":n>=2*this.firstCircleRadius+this.ballField&&n<3*this.firstCircleRadius+this.ballField?this.selected="third":this.selected="none",this.startAngle=Math.atan(e.y/e.x),this.startAngle=this.normalizeAngle(this.startAngle,e.x,e.y),this.startPos.x=e.x,this.startPos.y=e.y);else if("notsureh"==this.selected){if(Math.abs(e.x-this.startPos.x)>10*iPadMultiplier||Math.abs(e.y-this.startPos.y)>10*iPadMultiplier)Math.abs(e.y-this.startPos.y)<10*iPadMultiplier?this.selected="horizontal":n>=this.ballField&&n<this.ballField+this.firstCircleRadius?this.selected="first":n>=this.ballField+this.firstCircleRadius&&n<2*this.firstCircleRadius+this.ballField?this.selected="second":n>=2*this.firstCircleRadius+this.ballField&&n<3*this.firstCircleRadius+this.ballField?this.selected="third":this.selected="none",this.startAngle=Math.atan(e.y/e.x),this.startAngle=this.normalizeAngle(this.startAngle,e.x,e.y),this.startPos.x=e.x,this.startPos.y=e.y}else i>-this.ballField&&i<this.ballField?this.selected="notsure60":o>-this.ballField&&o<this.ballField?this.selected="notsure120":e.y>-this.ballField&&e.y<this.ballField?this.selected="notsureh":t>=this.ballField&&t<this.ballField+this.firstCircleRadius?this.selected="first":t>=this.ballField+this.firstCircleRadius&&t<2*this.firstCircleRadius+this.ballField?this.selected="second":t>=2*this.firstCircleRadius+this.ballField&&t<3*this.firstCircleRadius+this.ballField?this.selected="third":this.selected="nil";(this.selected=="first"||this.selected=="second"||this.selected=="third"||this.selected=="horizontal"||this.selected=="60"||this.selected=="120")&&this.setSelectedPath(this.selected)},this.mouseDown=function(e){var t=this.getAbsolutePosition();return e=ccp(e.x,e.y),e.x-=t.x,e.y-=t.y,e.x==0&&(e.x=1),this.startAngle=Math.atan(e.y/e.x),this.startAngle=this.normalizeAngle(this.startAngle,e.x,e.y),this.startPos=ccp(e.x,e.y),this.touchStartBalls=[this.balls[0][0],this.balls[1][0],this.balls[2][0],this.balls[3][0]],this.selectMethod(e),"nil"!=this.selectedMethod&&this.stopAllAnimation(),this.selectBall(e),!0},this.mouseOut=function(e){this.mouseUp(e)},this.mouseUp=function(e){var t=this.getAbsolutePosition();e=ccp(e.x,e.y),e.x-=t.x,e.y-=t.y,e.x==0&&(e.x=1);if("60"==this.selected)this.v60Animating=!0,this.constantV60Unit=Math.sin(188.4954/180)*this.ballField*10,this.constantH60Unit=Math.cos(188.4954/180)*this.ballField*10,this.addMoveToHistoryForPlaces(this.currentMove),this.currentMove=0;else if("120"==this.selected)this.v120Animating=!0,this.constantV60Unit=Math.sin(188.4954/180)*this.ballField*10,this.constantH60Unit=Math.cos(188.4954/180)*this.ballField*10,this.addMoveToHistoryForPlaces(this.currentMove),this.currentMove=0;else if("horizontal"==this.selected)this.horizontalAnimating=!0,this.constantHorizontalUnit=this.ballField*10,this.addMoveToHistoryForPlaces(this.currentMove),this.currentMove=0;else if("first"==this.selected){var n=Math.round(this.balls[1].length*this.firstCircleAngle/6.28312);this.moveForward(this.balls[1],n),this.firstCircleAngle=this.firstCircleAngle-n*2*3.14159/this.balls[1].length,this.firstCircleAngleAnimating=!0,this.initRotationForAngle(3.14159),this.addMoveToHistoryForPlaces(n)}else if("second"==this.selected){var n=Math.round(this.balls[2].length*this.secondCircleAngle/6.28312);this.moveForward(this.balls[2],n),this.secondCircleAngle=this.secondCircleAngle-n*2*3.14159/this.balls[2].length,this.secondCircleAngleAnimating=!0,this.initRotationForAngle(3.14159),this.addMoveToHistoryForPlaces(n)}else if("third"==this.selected){var n=Math.round(this.balls[3].length*this.thirdCircleAngle/6.28312);this.moveForward(this.balls[3],n),this.thirdCircleAngle=this.thirdCircleAngle-n*2*3.14159/this.balls[3].length,this.thirdCircleAngleAnimating=!0,this.initRotationForAngle(3.14159),this.addMoveToHistoryForPlaces(n)}this.pathSelected.visible=!1,this.updatePositions(),this.pathDeselected(),this.selected="",this.selectedBall!=null&&this.selectedBall.color!=0&&this.selectedBall.setSuffix("")},this.mouseMove=function(e){var t=this.getAbsolutePosition();e=ccp(e.x,e.y),e.x-=t.x,e.y-=t.y,e.x==0&&(e.x=1);if(this.selected=="")return;if("notsureh"==this.selected||"notsure60"==this.selected||"notsure120"==this.selected)this.selectMethod(e);else if("60"==this.selected){var n=this.calculateOnLineDistance(Math.sqrt(3),e);while(n>this.ballField){this.currentMove++,this.startPos.y+=Math.sin(60/180*3.14159)*this.ballField*2,this.startPos.x+=Math.cos(60/180*3.14159)*this.ballField*2;var r=this.balls[3][3];this.balls[3][3]=this.balls[2][2],this.balls[2][2]=this.balls[1][1],this.balls[1][1]=this.balls[0][0],this.balls[0][0]=this.balls[1][4],this.balls[1][4]=this.balls[2][8],this.balls[2][8]=this.balls[3][12],this.balls[3][12]=r,n=this.calculateOnLineDistance(Math.sqrt(3),e)}while(n<-this.ballField){this.currentMove--,this.startPos.y-=Math.sin(60/180*3.14159)*this.ballField*2,this.startPos.x-=Math.cos(60/180*3.14159)*this.ballField*2;var r=this.balls[3][12];this.balls[3][12]=this.balls[2][8],this.balls[2][8]=this.balls[1][4],this.balls[1][4]=this.balls[0][0],this.balls[0][0]=this.balls[1][1],this.balls[1][1]=this.balls[2][2],this.balls[2][2]=this.balls[3][3],this.balls[3][3]=r,n=this.calculateOnLineDistance(Math.sqrt(3),e)}this.v60Drift=Math.sin(60/180*3.14159)*n,this.h60Drift=Math.cos(60/180*3.14159)*n}else if("120"==this.selected){var i=this.calculateOnLineDistance(-Math.sqrt(3),e);while(i>this.ballField){this.currentMove++,this.startPos.y+=Math.sin(120/180*3.14159)*this.ballField*2,this.startPos.x+=Math.cos(120/180*3.14159)*this.ballField*2;var r=this.balls[3][6];this.balls[3][6]=this.balls[2][4],this.balls[2][4]=this.balls[1][2],this.balls[1][2]=this.balls[0][0],this.balls[0][0]=this.balls[1][5],this.balls[1][5]=this.balls[2][10],this.balls[2][10]=this.balls[3][15],this.balls[3][15]=r,i=this.calculateOnLineDistance(-Math.sqrt(3),e)}while(i<-this.ballField){this.currentMove--,this.startPos.y-=Math.sin(120/180*3.14159)*this.ballField*2,this.startPos.x-=Math.cos(120/180*3.14159)*this.ballField*2;var r=this.balls[3][15];this.balls[3][15]=this.balls[2][10],this.balls[2][10]=this.balls[1][5],this.balls[1][5]=this.balls[0][0],this.balls[0][0]=this.balls[1][2],this.balls[1][2]=this.balls[2][4],this.balls[2][4]=this.balls[3][6],this.balls[3][6]=r,i=this.calculateOnLineDistance(-Math.sqrt(3),e)}this.v120Drift=Math.sin(120/180*3.14159)*i,this.h120Drift=Math.cos(120/180*3.14159)*i}else if("horizontal"==this.selected){this.horizontalDrift=e.x-this.startPos.x;while(this.horizontalDrift>this.ballField){this.currentMove++,this.startPos.x+=this.ballField*2;var r=this.balls[3][0];this.balls[3][0]=this.balls[2][0],this.balls[2][0]=this.balls[1][0],this.balls[1][0]=this.balls[0][0],this.balls[0][0]=this.balls[1][3],this.balls[1][3]=this.balls[2][6],this.balls[2][6]=this.balls[3][9],this.balls[3][9]=r,this.horizontalDrift=e.x-this.startPos.x}while(this.horizontalDrift<=-this.ballField){this.currentMove--,this.startPos.x-=this.ballField*2;var r=this.balls[3][9];this.balls[3][9]=this.balls[2][6],this.balls[2][6]=this.balls[1][3],this.balls[1][3]=this.balls[0][0],this.balls[0][0]=this.balls[1][0],this.balls[1][0]=this.balls[2][0],this.balls[2][0]=this.balls[3][0],this.balls[3][0]=r,this.horizontalDrift=e.x-this.startPos.x}}else"first"==this.selected?(this.firstCircleAngle=Math.atan(e.y/e.x)-this.startAngle,this.firstCircleAngle=this.normalizeAngle(this.firstCircleAngle,e.x,e.y),this.firstCircleAngleAnimating=!1):"second"==this.selected?(this.secondCircleAngle=Math.atan(e.y/e.x)-this.startAngle,this.secondCircleAngle=this.normalizeAngle(this.secondCircleAngle,e.x,e.y),this.secondCircleAngleAnimating=!1):"third"==this.selected&&(this.thirdCircleAngle=Math.atan(e.y/e.x)-this.startAngle,this.thirdCircleAngle=this.normalizeAngle(this.thirdCircleAngle,e.x,e.y),this.thirdCircleAngleAnimating=!1);this.updatePositions()},this.addMoveToHistoryForPlaces=function(e){if(e==0)return;var t=-1;this.selected=="first"?t=this.balls[1].length:this.selected=="second"?t=this.balls[2].length:this.selected=="third"&&(t=this.balls[3].length);var n={selected:this.selected,places:e};if(this.moveHistory.length>0){var r=this.moveHistory[this.moveHistory.length-1];if(this.selected==r.selected)if(e==-r.places||e==r.places&&(t/2==e||t/2==-e)){this.moveHistory.pop(),this.circleDelegate!=null&&this.circleDelegate.addMoves(-1);return}}this.moveHistory.push(n),this.circleDelegate.addMoves(1)},this.moveForward=function(e,t){if(t>0)for(var n=0;n<t;n++)e.splice(0,0,e.pop());else for(var n=0;n<-t;n++)e.push(e[0]),e.splice(0,1)},this.initRotationForAngle=function(e){e<0&&(e*=-1),this.constantRotationUnit=e/.4},this.pathDeselected=function(){if(this.selected=="first")for(var e=0;e<this.balls[1].length;e++)this.balls[1][e].setSuffix("");else if(this.selected=="second")for(var e=0;e<this.balls[2].length;e++)this.balls[2][e].setSuffix("");else if(this.selected=="third")for(var e=0;e<this.balls[3].length;e++)this.balls[3][e].setSuffix("");else this.selected=="horizontal"?(this.balls[0][0].setSuffix(""),this.balls[1][0].setSuffix(""),this.balls[1][3].setSuffix(""),this.balls[2][0].setSuffix(""),this.balls[2][6].setSuffix(""),this.balls[3][0].setSuffix(""),this.balls[3][9].setSuffix("")):this.selected=="60"?(this.balls[0][0].setSuffix(""),this.balls[1][1].setSuffix(""),this.balls[1][4].setSuffix(""),this.balls[2][2].setSuffix(""),this.balls[2][8].setSuffix(""),this.balls[3][3].setSuffix(""),this.balls[3][12].setSuffix("")):this.selected=="120"&&(this.balls[0][0].setSuffix(""),this.balls[1][2].setSuffix(""),this.balls[1][5].setSuffix(""),this.balls[2][4].setSuffix(""),this.balls[2][10].setSuffix(""),this.balls[3][6].setSuffix(""),this.balls[3][15].setSuffix(""))},this.showPath=function(e){e=="60"?(e="horizontal",this.pathSelected.rotation=-60):e=="120"?(e="horizontal",this.pathSelected.rotation=-120):this.pathSelected.rotation=0,this.pathSelected.setFile("pathsSelected-"+e+".png"),this.pathSelected.position=ccp(0,0),this.pathSelected.visible=!0},this.hidePath=function(){this.pathSelected.visible=!1},this.historyUndo=function(){if(this.moveHistory.length<=0)return 0;var e=this.moveHistory.pop(),t=e.places;return this.circleDelegate.addMoves(-1),"60"==e.selected?(this.constantV60Unit=Math.sin(188.4954/180)*this.ballField*Math.abs(e.places)/.2,this.constantH60Unit=Math.cos(188.4954/180)*this.ballField*Math.abs(e.places)/.2,this.currentDelay=.2/Math.abs(e.places),this.addMove60ForPlaces(e.places),this.currentMove=0):"120"==e.selected?(this.constantV60Unit=Math.sin(188.4954/180)*this.ballField*Math.abs(e.places)/.2,this.constantH60Unit=Math.cos(188.4954/180)*this.ballField*Math.abs(e.places)/.2,this.currentDelay=.2/Math.abs(e.places),this.addMove120ForPlaces(e.places),this.currentMove=0):"horizontal"==e.selected?(this.constantHorizontalUnit=this.ballField*Math.abs(e.places)/.2,this.currentDelay=.2/Math.abs(e.places),this.addMoveHorizontalForPlaces(e.places),this.currentMove=0):"first"==e.selected?(this.firstCircleAngle=this.firstCircleAngle+e.places*2*3.14159/this.balls[1].length,this.moveForward(this.balls[1],-e.places),this.firstCircleAngleAnimating=!0,this.initRotationForAngle(this.firstCircleAngle)):"second"==e.selected?(this.secondCircleAngle=this.secondCircleAngle+e.places*2*3.14159/this.balls[2].length,this.moveForward(this.balls[2],-e.places),this.initRotationForAngle(this.secondCircleAngle),this.secondCircleAngleAnimating=!0):"third"==e.selected&&(this.thirdCircleAngle=this.thirdCircleAngle+e.places*2*3.14159/this.balls[3].length,this.moveForward(this.balls[3],-e.places),this.initRotationForAngle(this.thirdCircleAngle),this.thirdCircleAngleAnimating=!0),t},this.addMoveHorizontalForPlaces=function(e){var t=e;this.horizontalAnimating=!0;var n=t;n>0&&(n=1),n<0&&(n=-1),this.horizontalDrift=n*this.ballField*2;if(t<0){t++;var r=this.balls[3][0];this.balls[3][0]=this.balls[2][0],this.balls[2][0]=this.balls[1][0],this.balls[1][0]=this.balls[0][0],this.balls[0][0]=this.balls[1][3],this.balls[1][3]=this.balls[2][6],this.balls[2][6]=this.balls[3][9],this.balls[3][9]=r}if(t>0){t--;var r=this.balls[3][9];this.balls[3][9]=this.balls[2][6],this.balls[2][6]=this.balls[1][3],this.balls[1][3]=this.balls[0][0],this.balls[0][0]=this.balls[1][0],this.balls[1][0]=this.balls[2][0],this.balls[2][0]=this.balls[3][0],this.balls[3][0]=r}if(t!=0){var i=new JDelayTime(this.currentDelay),s=new JCallFuncO(this,"addMoveHorizontalForPlaces",t);this.runAction(new JSequence([i,s]))}},this.addMove60ForPlaces=function(e){var t=e;this.v60Animating=!0;var n=t;n>0&&(n=1),n<0&&(n=-1),this.v60Drift=Math.sin(60/180*3.14159)*n*this.ballField*2,this.h60Drift=Math.cos(60/180*3.14159)*n*this.ballField*2;if(t<0){t++;var r=this.balls[3][3];this.balls[3][3]=this.balls[2][2],this.balls[2][2]=this.balls[1][1],this.balls[1][1]=this.balls[0][0],this.balls[0][0]=this.balls[1][4],this.balls[1][4]=this.balls[2][8],this.balls[2][8]=this.balls[3][12],this.balls[3][12]=r}if(t>0){t--;var r=this.balls[3][12];this.balls[3][12]=this.balls[2][8],this.balls[2][8]=this.balls[1][4],this.balls[1][4]=this.balls[0][0],this.balls[0][0]=this.balls[1][1],this.balls[1][1]=this.balls[2][2],this.balls[2][2]=this.balls[3][3],this.balls[3][3]=r}if(t!=0){var i=new JDelayTime(this.currentDelay),s=new JCallFuncO(this,"addMove60ForPlaces",t);this.runAction(new JSequence([i,s]))}},this.addMove120ForPlaces=function(e){var t=e;this.v120Animating=!0;var n=t;n>0&&(n=1),n<0&&(n=-1),this.v120Drift=Math.sin(120/180*3.14159)*n*this.ballField*2,this.h120Drift=Math.cos(120/180*3.14159)*n*this.ballField*2;if(t<0){t++;var r=this.balls[3][6];this.balls[3][6]=this.balls[2][4],this.balls[2][4]=this.balls[1][2],this.balls[1][2]=this.balls[0][0],this.balls[0][0]=this.balls[1][5],this.balls[1][5]=this.balls[2][10],this.balls[2][10]=this.balls[3][15],this.balls[3][15]=r}if(t>0){t--;var r=this.balls[3][15];this.balls[3][15]=this.balls[2][10],this.balls[2][10]=this.balls[1][5],this.balls[1][5]=this.balls[0][0],this.balls[0][0]=this.balls[1][2],this.balls[1][2]=this.balls[2][4],this.balls[2][4]=this.balls[3][6],this.balls[3][6]=r}if(t!=0){var i=new JDelayTime(this.currentDelay),s=new JCallFuncO(this,"addMove120ForPlaces",t);this.runAction(new JSequence([i,s]))}},this.init()}function Level(){this.startOrder=[],this.finishOrder=[],this.levelId=0,this.title="",this.minMoves=0;for(var e=0;e<4;e++)this.startOrder[e]=[],this.finishOrder[e]=[];this.loadFromReader=function(e){var t;this.levelId=-1;var n=0;while((t=e.readTrimmedLine())!=null){if(";"==t)break;this.levelId==-1&&(this.levelId=parseInt(t.substring(0,t.indexOf(" "))),this.title=t.substring(t.indexOf(" ")+1)),n==1&&(this.startOrder[0][0]=parseInt(t));if(n==2){var r=t.split(" ");for(var i=0;i<r.length&&i<6;i++)this.startOrder[1][i]=parseInt(r[i])}if(n==3){var r=t.split(" ");for(var i=0;i<r.length&&i<12;i++)this.startOrder[2][i]=parseInt(r[i])}if(n==4){var r=t.split(" ");for(var i=0;i<r.length&&i<18;i++)this.startOrder[3][i]=parseInt(r[i])}n==5&&(this.finishOrder[0][0]=parseInt(t));if(n==6){var r=t.split(" ");for(var i=0;i<r.length&&i<6;i++)this.finishOrder[1][i]=parseInt(r[i])}if(n==7){var r=t.split(" ");for(var i=0;i<r.length&&i<12;i++)this.finishOrder[2][i]=parseInt(r[i])}if(n==8){var r=t.split(" ");for(var i=0;i<r.length&&i<18;i++)this.finishOrder[3][i]=parseInt(r[i])}n==9&&(this.minMoves=parseInt(t)),n++}}}function LineReader(e){this.str=e.split("\n"),this.last=0,this.readLine=function(){return this.last>=this.str.length?null:this.str[this.last++]},this.readTrimmedLine=function(){var e=this.readLine();return e!=null&&e.trim(),e},this.readInt=function(){var e=this.readLine();return e!=null?parseInt(e):e}}function JellyEye(){this.extend(Node),this.init=function(){this.isMouseEnabled=!0,this.retina=new Sprite("gameBackground-eyeRetina.png"),this.pupil=new Sprite("gameBackground-eyePupil.png"),this.shine=new Sprite("gameBackground-eyeShine.png"),this.eyeCap=new Sprite("gameBackground-eyeCap.png"),this.eyeOpen=new Sprite("gameBackground-eyeOpen.png"),this.addChild(this.retina),this.addChild(this.pupil),this.addChild(this.shine),this.addChild(this.eyeOpen),this.addChild(this.eyeCap);var e=new JMoveBy(.1,ccp(.5,.5)),t=new JMoveBy(.1,ccp(-0.5,-0.5));this.shine.runAction(new JRepeatForever(new JSequence([e,t]))),this.updateLayout()},this.updateLayout=function(){this.eyeCap.position=ccp(0,95*iPadMultiplier)},this.blink=function(){var e=new JMoveBy(.2,ccp(0,-90*iPadMultiplier)),t=new JMoveBy(.2,ccp(0,90*iPadMultiplier));this.eyeCap.runAction(new JSequence([e,t]))},this.mouseMove=function(e){e=this.getAbsolutePosition(e),this.pupil.position=ccp(e.x/engine.size.width*30*iPadMultiplier,e.y/engine.size.height*30*iPadMultiplier)},this.mouseOut=function(e){e=this.getAbsolutePosition(e),this.pupil.runAction(new JMoveTo(.2,ccp(0,0)))},this.init()}function GameStars(){this.extend(Node),this.init=function(){this.currentCount=-1,this.star1=new Sprite("finishedStarFull.png"),this.star1.rotation=-14,this.star2=new Sprite("finishedStarFull.png"),this.star3=new Sprite("finishedStarFull.png"),this.star3.rotation=14,this.addChild(this.star1),this.addChild(this.star2),this.addChild(this.star3)},this.updateLayout=function(){this.star1.position=ccp(-this.star1.size.width,0),this.star2.position=ccp(0,this.star2.size.height/2-29*iPadMultiplier),this.star3.position=ccp(this.star3.size.width,0)},this.setCount=function(e){e>0?this.star1.setFile("finishedStarFull.png"):this.star1.setFile("finishedStarEmpty.png"),e>1?this.star2.setFile("finishedStarFull.png"):this.star2.setFile("finishedStarEmpty.png"),e>2?this.star3.setFile("finishedStarFull.png"):this.star3.setFile("finishedStarEmpty.png")},this.init()}function FinishedStars(){this.extend(Node),this.init=function(){this.currentCount=-1,this.star1Full=new Sprite("finishedStarFull.png"),this.star1Full.rotation=-10,this.star2Full=new Sprite("finishedStarFull.png"),this.star3Full=new Sprite("finishedStarFull.png"),this.star3Full.rotation=10,this.star1Empty=new Sprite("finishedStarEmpty.png"),this.star1Empty.rotation=-10,this.star2Empty=new Sprite("finishedStarEmpty.png"),this.star3Empty=new Sprite("finishedStarEmpty.png"),this.star3Empty.rotation=10,this.addChild(this.star1Empty),this.addChild(this.star2Empty),this.addChild(this.star3Empty),this.addChild(this.star1Full),this.addChild(this.star2Full),this.addChild(this.star3Full)},this.updateLayout=function(){this.star1Full.position=ccp(-this.star1Full.size.width+14,0),this.star2Full.position=ccp(0,this.star2Full.size.height/2-18),this.star3Full.position=ccp(this.star3Full.size.width-14,0),this.star1Empty.position=ccp(-this.star1Empty.size.width+14,0),this.star2Empty.position=ccp(0,this.star2Empty.size.height/2-18),this.star3Empty.position=ccp(this.star3Empty.size.width-14,0)},this.setCount=function(e){this.currentCount=e;var t=[this.star1Full,this.star2Full,this.star3Full];for(var n=0;n<3;n++)if(this.currentCount>=n+1){t[n].visible=!0,t[n].scale=10,t[n].opacity=0,t[n].stopAllActions();var r=new JSpawn([new JScaleTo(.5,1),new JFadeIn(.5)]),i=new JDelayTime(n*.5),s=new JSequence([i,r]);t[n].runAction(s)}else t[n].visible=!1},this.init()}function FinishedScreen(){this.extend(Node),this.isMouseEnabled=!0,this.init=function(){this.active=!1,this.visible=!1,this.menu=new JMenu,this.box=new Sprite("finishedMenuBackground.png"),this.box.isMouseEnabled=!0,this.gray=new Sprite("finishedMenuBackgroundSunburst.png"),this.gray.scale=2,this.gray.opacity=0,this.stars=new FinishedStars,this.nextButton=new JMenuItemImage("finishedNextButton.png","finishedNextButtonSelected.png",this,"internalNextButtonTouched"),this.restartButton=new JMenuItemImage("finishedRestartButton.png","finishedRestartButtonSelected.png",this,"internalRestartButtonTouched"),this.restartButton.scale=.8,this.menu.addChild(this.restartButton),this.menu.addChild(this.nextButton),this.box.addChild(this.menu),this.box.addChild(this.stars),this.addChild(this.gray),this.addChild(this.box)},this.updateLayout=function(){this.restartButton.position=ccp(0,-95*iPadMultiplier),this.nextButton.position=ccp(0,-100*iPadMultiplier+63*iPadMultiplier),this.stars.position=ccp(0,18*iPadMultiplier),this.active?this.box.position=ccp(0,0):this.box.position=ccp(0,engine.size.height/2+150*iPadMultiplier)},this.internalNextButtonTouched=function(){this.nextButtonTouched()},this.internalRestartButtonTouched=function(){var e=new JRotateBy(.4,360),t=new JCallFunc(this,"restartButtonTouched");this.restartButton.runAction(new JSequence([e,t]))},this.show=function(){if(this.isAndroid==undefined){var e=navigator.userAgent.toLowerCase();this.isAndroid=e.match(/android/i)=="android"}this.count?this.count++:this.count=1;if(this.count>1&&this.isAndroid)var t=new JMoveBy(.4,ccp(0,-(engine.size.height/2+150*iPadMultiplier)*2));else var t=new JMoveBy(.4,ccp(0,-(engine.size.height/2+150*iPadMultiplier)));this.box.runAction(t),this.gray.runAction(new JFadeIn(.4)),this.visible=!0},this.hide=function(){this.box.runAction(new JMoveBy(.4,ccp(0,engine.size.height/2+150*iPadMultiplier)));var e=new JCallFunc(this,"hidden");this.gray.runAction(new JSequence([new JFadeOut(.4),e]))},this.hidden=function(){this.visible=!1},this.init()}function GameCompletedScreen(){this.extend(Node),this.isMouseEnabled=!0,this.init=function(){this.active=!1,this.visible=!1,this.menu=new JMenu,this.box=new Sprite("finishedMenuBackground1.png"),this.box.isMouseEnabled=!0,this.gray=new Sprite("finishedMenuBackgroundSunburst.png"),this.gray.scale=2,this.gray.opacity=0,this.stars=new FinishedStars,this.restartButton=new JMenuItemImage("finishedRestartButton.png","finishedRestartButtonSelected.png",this,"internalRestartButtonTouched"),this.restartButton.scale=1,this.menu.addChild(this.restartButton),this.labelHolder=new Node;var e=new JLabel("","",13,2),t=new JLabel("感谢你玩这个游戏!","",13,2),n=new JLabel("你已通过全部关卡！","",13,2),r=new JLabel("","",13,2);e.position=ccp(-1*iPadMultiplier,30*iPadMultiplier),t.position=ccp(0,1*iPadMultiplier),n.position=ccp(0,-19*iPadMultiplier),r.position=ccp(0,-39*iPadMultiplier),this.labelHolder.addChild(e),this.labelHolder.addChild(t),this.labelHolder.addChild(n),this.labelHolder.addChild(r),this.box.addChild(this.labelHolder),this.box.addChild(this.menu),this.box.addChild(this.stars),this.addChild(this.gray),this.addChild(this.box)},this.updateLayout=function(){this.restartButton.position=ccp(90*iPadMultiplier,0*iPadMultiplier),this.stars.position=ccp(-41*iPadMultiplier,75*iPadMultiplier),this.labelHolder.position=ccp(-37*iPadMultiplier,3*iPadMultiplier),this.active?this.box.position=ccp(0,0):this.box.position=ccp(0,engine.size.height/2+150*iPadMultiplier)},this.internalRestartButtonTouched=function(){var e=new JRotateBy(.4,360),t=new JCallFunc(this,"restartButtonTouched");this.restartButton.runAction(new JSequence([e,t]))},this.show=function(){var e=new JMoveBy(.4,ccp(0,-(engine.size.height/2+150*iPadMultiplier)));this.box.runAction(e),this.gray.runAction(new JFadeIn(.4)),this.visible=!0},this.hide=function(){this.box.runAction(new JMoveBy(.4,ccp(0,engine.size.height/2+150*iPadMultiplier)));var e=new JCallFunc(this,"hidden");this.gray.runAction(new JSequence([new JFadeOut(.4),e]))},this.hidden=function(){this.visible=!1},this.init()}function HelpScreen(){this.extend(Node),this.isMouseEnabled=!0,this.screenCount=8,this.currentSpriteNo=1,this.init=function(){this.sprite=new Sprite("help01.png"),this.ttContinue=new JLabel("(点击继续)","",15,3),this.ttContinue.position=ccp(2,-52),this.addChild(this.sprite),this.addChild(this.ttContinue)},this.mouseUp=function(){this.currentSpriteNo++;if(this.currentSpriteNo>8){this.isMouseEnabled=!1,this.sprite.runAction(new JSequence([new JFadeOut(.5),new JCallFunc(this,"internalHidden")])),this.ttContinue.runAction(new JFadeOut(.5));return}if(this.currentSpriteNo==2){var e=new JCallFuncO(this.parent.circle,"showPath","horizontal"),t=new JCallFuncO(this.parent.circle,"showPath","60"),n=new JCallFuncO(this.parent.circle,"showPath","120"),r=new JCallFunc(this.parent.circle,"hidePath"),i=new JDelayTime(1.5),s=new JDelayTime(.7),o=new JDelayTime(.7),u=new JDelayTime(.7),a=new JSequence([i,e,s,t,o,n,u,r]);a.tag=1,this.runAction(a)}else if(this.currentSpriteNo==3){this.parent.circle.hidePath(),this.stopActionByTag(1);var e=new JCallFuncO(this.parent.circle,"showPath","first"),t=new JCallFuncO(this.parent.circle,"showPath","second"),n=new JCallFuncO(this.parent.circle,"showPath","third"),r=new JCallFunc(this.parent.circle,"hidePath"),i=new JDelayTime(.8),s=new JDelayTime(.7),o=new JDelayTime(.7),u=new JDelayTime(.7),f=new JSequence([i,e,s,t,o,n,u,r]);f.tag=2,this.runAction(f)}else this.currentSpriteNo==4&&(this.parent.circle.hidePath(),this.stopActionByTag(2));this.sprite.setFile("help0"+this.currentSpriteNo+".png")},this.internalHidden=function(){this.visible=!1,this.hidden()},this.init()}function GameTypePuzzle(){this.extend(Node),this.isMouseEnabled=!0,this.levelGroups=[],this.levels=[],this.moveCount=0,this.currentLevel=null,this.currentLevelNo=0;var e=this;this.position=ccp(engine.size.width/2,engine.size.height/2),this.init=function(){this.loadLevels(),this.circle=new TouchableCircle,this.circle.circleDelegate=this,this.puzzleBackground=new Sprite("puzzleBackground-0.png"),this.leftEye=new JellyEye,this.rightEye=new JellyEye,this.rightEye.eyeCap.scaleDual.x=-1,this.rightEye.eyeOpen.scaleDual.x=-1,this.leftEyeCircle=new Sprite("gameBackground-eyeCircle.png"),this.rightEyeCircle=new Sprite("gameBackground-eyeCircle.png"),this.backgroundSprite=new Sprite("gameBackground-puzzleBackground.png"),this.blackCircle=new Sprite("gameBackground-blackCircle.png"),this.labelHolder=new Node,this.labelHolderBackground=new Sprite("gameBackground-movesBackground.png"),this.titleLabel=new JLabel("None","defaultFont",14*iPadMultiplier,2),this.moveCountNoLabel=new JLabel("0","defaultFont",16*iPadMultiplier,2),this.minMovesNoLabel=new JLabel("0","defaultFont",16*iPadMultiplier,2),this.currentStars=new GameStars,this.currentStars.scale=.5,this.labelHolder.addChild(this.labelHolderBackground),this.labelHolder.addChild(this.titleLabel),this.labelHolder.addChild(this.moveCountNoLabel),this.labelHolder.addChild(this.minMovesNoLabel),this.undoButton=new JMenuItemImage("menuButtonUndo.png","menuButtonUndoClicked.png",this,"undoButtonTouched"),this.levelSelectorButton=new JMenuItemImage("menuButtonLevelsClicked.png","menuButtonLevelsClicked.png",this,"levelSelectorButtonTouched"),this.reloadButton=new JMenuItemImage("menuButtonReload.png","menuButtonReloadClicked.png",this,"reloadButtonTouched"),this.homeButton=new JMenuItemImage("menuButtonHomeClicked.png","menuButtonHomeClicked.png",this,"homeButtonTouched"),this.homeButton.position=ccp(-130*iPadMultiplier,-2*iPadMultiplier),this.levelSelectorButton.position=ccp(-74*iPadMultiplier,1*iPadMultiplier),this.reloadButton.position=ccp(-18*iPadMultiplier,4*iPadMultiplier),this.undoButton.position=ccp(38*iPadMultiplier,3*iPadMultiplier),this.gameMenu=new JMenu([this.undoButton,this.levelSelectorButton,this.reloadButton,this.homeButton]),this.firstHolderBackground=new Sprite("menuBackgroundGame.png"),this.gameMenu.addChildZ(this.firstHolderBackground,-1),this.miniCircle=new CircleMini(this.circle.firstCircleRadius/6*1.8,""),this.miniCircle.scale=1/1.2,this.miniCircleBackground=new Sprite("gameBackground-NetBackground-0.png"),this.miniCircleBackground.addChildZ(this.miniCircle,1),this.gameMenu.addChild(this.miniCircleBackground),this.finishedScreen=new FinishedScreen,this.finishedScreen.nextButtonTouched=function(){e.finishedScreenNextButtonTouched()},this.finishedScreen.restartButtonTouched=function(){e.finishedScreenRestartButtonTouched()},this.gameCompletedScreen=new GameCompletedScreen,this.gameCompletedScreen.restartButtonTouched=function(){e.gameCompletedScreenRestartButtonTouched()},this.addChild(this.leftEye),this.addChild(this.rightEye),this.addChild(this.puzzleBackground),this.addChild(this.circle),this.addChild(this.backgroundSprite),this.addChild(this.blackCircle),this.addChild(this.leftEyeCircle),this.addChild(this.rightEyeCircle),this.addChild(this.currentStars),this.addChild(this.labelHolder),this.addChild(this.gameMenu),this.addChild(this.finishedScreen),this.addChild(this.gameCompletedScreen);var t=Util.getCookie("helpShown");if(t==null||t=="")this.circle.isMouseEnabled=!1,this.gameMenu.isMouseEnabled=!1,this.helpScreen=new HelpScreen,this.helpScreen.hidden=function(){e.helpLayerHidden()},this.addChild(this.helpScreen);this.activateLevel(this.currentLevelNo)},this.updateLayout=function(){var e=engine.size;this.circle.position=ccp(0,-15*iPadMultiplier),this.puzzleBackground.position=ccp(0,-15*iPadMultiplier),this.blackCircle.position=ccp(0,-15*iPadMultiplier),this.leftEye.position=ccp(-108*iPadMultiplier,e.height/2+this.backgroundSprite.size.height/2-52*iPadMultiplier-20*iPadMultiplier),this.leftEye.position=ccp(-108*iPadMultiplier,this.backgroundSprite.size.height/2-52*iPadMultiplier-20*iPadMultiplier),this.rightEye.position=ccp(108*iPadMultiplier,this.backgroundSprite.size.height/2-52*iPadMultiplier-20*iPadMultiplier),this.leftEyeCircle.position=ccp(-108*iPadMultiplier,this.backgroundSprite.size.height/2-52*iPadMultiplier-20*iPadMultiplier),this.rightEyeCircle.position=ccp(108*iPadMultiplier,this.backgroundSprite.size.height/2-52*iPadMultiplier-20*iPadMultiplier),this.labelHolder.position=ccp(0,e.height/2-this.labelHolderBackground.size.height/2),this.titleLabel.position=ccp(0,25*iPadMultiplier),this.currentStars.position=ccp(0,151*iPadMultiplier),this.minMovesNoLabel.position=ccp(30*iPadMultiplier,-18*iPadMultiplier),this.moveCountNoLabel.position=ccp(-21*iPadMultiplier,-18*iPadMultiplier),this.gameMenu.position=ccp(0,-e.height/2+this.firstHolderBackground.size.height/2),this.miniCircleBackground.position=ccp(113*iPadMultiplier,26*iPadMultiplier),this.finishedScreen.position=ccp(0,0)},this.loadLevels=function(){var e=new LineReader(Util.xmlGetUrl("levels.xml"));e.readLine();var t=e.readInt(),n=e.readInt();for(var r=0;r<n;r++){line=e.readLine();var i={};i.title=line.substring(0,line.indexOf(":")),i.toId=parseInt(line.substring(line.indexOf(":")+1)),i.levels=[],this.levelGroups.push(i)}var i=this.levelGroups[0],s=1,o=0;for(var r=0;r<t;r++){r>=i.toId&&(i=this.levelGroups[++o],s=1);var u=new Level;u.loadFromReader(e),u.levelId=r+1,u.no=s,i.levels.push(u),this.levels.push(u),s++}},this.levelRotationFinished=function(){this.circle.rotation=0,this.reloadButton.enabled=!0},this.activateLevel=function(e){this.circle.moveHistory=[];if(this.currentLevel!=null){var t=new JRotateBy(1,360),n=new JCallFunc(this,"levelRotationFinished");this.circle.runAction(new JSequence([t,n])),t=new JDelayTime(.5),n=new JCallFuncO(this,"activateLevelInternal",e),this.runAction(new JSequence([t,n]))}else this.activateLevelInternal(e)},this.activateLevelInternal=function(e){this.moveCount=0,this.circle.loadLevel(this.levels[e]),this.miniCircle.loadLevel(this.levels[e]),this.currentLevel=this.levels[e],this.currentLevelNo=e,this.leftEye.blink(),this.rightEye.blink(),this.minMovesNoLabel.setText(this.currentLevel.minMoves),this.updateMoveCount(),this.titleLabel.setText(this.currentLevel.levelId+". "+this.currentLevel.title),this.currentStars.setCount(this.starsFromMoves(this.moveCount+1,this.currentLevel.minMoves))},this.updateMoveCount=function(){this.moveCountNoLabel.setText(this.moveCount)},this.levelPassed=function(){this.circle.isMouseEnabled=!1,this.gameMenu.isMouseEnabled=!1,engine.log("ozzlejs","passedLevel."+this.currentLevelNo,this.moveCount),this.currentLevelNo==11?(this.gameCompletedScreen.stars.setCount(this.starsFromMoves(this.moveCount,this.currentLevel.minMoves)),this.gameCompletedScreen.show()):(this.finishedScreen.stars.setCount(this.starsFromMoves(this.moveCount,this.currentLevel.minMoves)),this.finishedScreen.show())},this.finishedScreenNextButtonTouched=function(){this.circle.isMouseEnabled=!0,this.gameMenu.isMouseEnabled=!0,this.activateLevel(this.currentLevelNo+1),this.finishedScreen.hide()},this.finishedScreenRestartButtonTouched=function(){this.circle.isMouseEnabled=!0,this.gameMenu.isMouseEnabled=!0,this.activateLevel(this.currentLevelNo),this.finishedScreen.hide()},this.gameCompletedScreenRestartButtonTouched=function(){this.circle.isMouseEnabled=!0,this.gameMenu.isMouseEnabled=!0,this.activateLevel(0),this.gameCompletedScreen.hide()},this.helpLayerHidden=function(){this.circle.isMouseEnabled=!0,this.gameMenu.isMouseEnabled=!0,Util.setCookie("helpShown","1",365)},this.starsFromMoves=function(e,t){var n=0;return e==0?n:(e<=t*t+1&&(n=1),e<=t*2&&(n=2),e<=t&&(n=3),n)},this.addMoves=function(e){this.moveCount+=e,this.moveCount>99&&(this.moveCount=99),this.updateMoveCount();if(this.circle.isEqualToColors(this.currentLevel.finishOrder)==1){this.levelPassed();return}this.currentStars.setCount(this.starsFromMoves(this.moveCount+1,this.currentLevel.minMoves))},this.homeButtonTouched=function(){},this.levelSelectorButtonTouched=function(){},this.reloadButtonTouched=function(){this.reloadButton.enabled=!1,this.activateLevel(this.currentLevelNo)},this.enableUndo=function(){this.undoButton.enabled=!0},this.undoButtonTouched=function(){this.undoButton.enabled=!1,this.circle.historyUndo();var e=new JDelayTime(.4),t=new JCallFunc(this,"enableUndo");this.runAction(new JSequence([e,t]))},this.update=function(e){},this.init()}function PreloaderScene(){this.extend(Node);var e=this;this.isMouseEnabled=!1,this.init=function(){this.position=ccp(engine.size.width/2,engine.size.height/2),this.noColor=new Sprite("LoadingScreenNoColour.png"),this.withColor=new SpriteCutOutHeight("LoadingScreenColour.png"),this.upper=new Sprite("LoadingScreenMouthEyesLogo.png"),this.text=new Sprite("clicktoplay.png"),this.text.visible=!1,this.text.position=ccp(0,-17),this.text.opacity=.8,this.addChild(this.noColor),this.addChild(this.withColor),this.addChild(this.upper),this.addChild(this.text)},this.fadedOut=function(){this.visible=!1,engine.removePreloaderScene()},this.setPercentage=function(t){t==1&&(engine.fps=10,e.isMouseEnabled=!0,e.text.visible=!0),e.withColor.cutHeight=e.withColor.size.height-e.withColor.size.height*t},this.mouseDown=function(e){e=this.getAbsolutePosition(e);var t=!1;this.text.position.x-this.text.size.width/2<=e.x&&this.text.position.x+this.text.size.width/2>=e.x&&this.text.position.y-this.text.size.height/2<=e.y&&this.text.position.y+this.text.size.height/2>=e.y&&(t=!0),t&&(this.text.opacity=.6)},this.mouseUp=function(t){t=this.getAbsolutePosition(t);if(this.text.position.x-this.text.size.width/2<=t.x&&this.text.position.x+this.text.size.width/2>=t.x&&this.text.position.y-this.text.size.height/2<=t.y&&this.text.position.y+this.text.size.height/2>=t.y){this.analyticsTrack(),engine.log("ozzlejs","playClicked",""),engine.fps=100,engine.scene.visible=!0,this.text.opacity=1,this.isMouseEnabled=!1,e.noColor.visible=!1;var n=new JFadeOut(1),r=new JCallFunc(e,"fadedOut");e.withColor.runAction(new JSequence([n,r])),e.upper.runAction(new JFadeOut(1)),e.text.runAction(new JFadeOut(1)),setTimeout(function(){engine.updateLayout()},100)}},this.mouseMove=function(e){e=this.getAbsolutePosition(e);var t=!1;this.text.position.x-this.text.size.width/2<=e.x&&this.text.position.x+this.text.size.width/2>=e.x&&this.text.position.y-this.text.size.height/2<=e.y&&this.text.position.y+this.text.size.height/2>=e.y&&(t=!0),t?this.text.opacity=1:this.text.opacity=.8},this.analyticsTrack=function(){},this.init()}function Ozzle(e){engine.log("ozzlejs","init",""),engine.setCanvas(e);var t=new PreloaderScene;engine.loader.setPercentage=t.setPercentage,engine.setPreloaderScene(t);var n=["pathsSelected-first.png","pathsSelected-second.png","pathsSelected-third.png","pathsSelected-horizontal.png"];for(var r=0;r<9;r++)n.push("balls/ball-"+r+".png"),n.push("balls/ball-"+r+"-white.png"),n.push("balls/ball-"+r+"-mini.png");for(var r=1;r<9;r++)n.push("help0"+r+".png");engine.loader.preloadImages(n);var i=new GameTypePuzzle;i.visible=!1,engine.setScene(i)}String.prototype.trim=function(){return this.replace(/^\s\s*/,"").replace(/\s\s*$/,"")};var Util=new UtilClass,scheduler=new SchedulerClass,TO_DEG=180/3.14159,TO_RAD=3.14195/180,iPadMultiplier=1,ctx=null;Object.prototype.extend=function(e){this.__extend=e,this.__extend()};var JWhite=ccc4(255,255,255,1),JBlack=ccc4(0,0,0,1),engine=new EngineClass;ctx=null;